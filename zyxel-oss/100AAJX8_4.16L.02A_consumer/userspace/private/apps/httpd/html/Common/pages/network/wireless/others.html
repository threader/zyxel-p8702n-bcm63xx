<script language="javascript">
<!-- hide


var forNorway  = '1';
var extDtm = '<%ejGetExtWl(extWlDtmIntvl)%>';
var extBcn = '<%ejGetExtWl(extWlBcnIntvl)%>';
var forTDCQTN  = '0';
var sessionkey = '<%ejGetOther(sessionKey)%>';
var errMsg = "<%ejGetOther(errMsg)%>";
var AllwifiVarStr = '<%ejGetWlAll(wlVarForOther)%>';
var AllwifiVarStrArr = AllwifiVarStr.split("|", 128);

var syncNvram = AllwifiVarStrArr[0];
var enbl = AllwifiVarStrArr[1];
var country = AllwifiVarStrArr[2];
var channel = AllwifiVarStrArr[3];
var rate = AllwifiVarStrArr[4];
var frg = AllwifiVarStrArr[5];
var rts = AllwifiVarStrArr[6];
var dtm = AllwifiVarStrArr[7];
var bcn = AllwifiVarStrArr[8];
var phy = AllwifiVarStrArr[9];
var brate = AllwifiVarStrArr[10];
var gmode = AllwifiVarStrArr[11];
var pro = AllwifiVarStrArr[12];
var pre = AllwifiVarStrArr[13];
var band= AllwifiVarStrArr[14];
var mcastrate = AllwifiVarStrArr[15];
var hasafterburner = AllwifiVarStrArr[16];
var afterburneren = AllwifiVarStrArr[17];
var bands = AllwifiVarStrArr[18];
var mode = AllwifiVarStrArr[19];
var wlRefresh = AllwifiVarStrArr[20];
var TxPwrPcnt = AllwifiVarStrArr[21];
var reg_mode = AllwifiVarStrArr[22];
var dfs_preism = AllwifiVarStrArr[23];
var dfs_postism = AllwifiVarStrArr[24];
var tpcDb = AllwifiVarStrArr[25];
var wme = AllwifiVarStrArr[26];
var csscantimer = AllwifiVarStrArr[27];
var nctrlsb = AllwifiVarStrArr[28];
var corerev = AllwifiVarStrArr[29];
var npro = AllwifiVarStrArr[30];
var nmcsidx = AllwifiVarStrArr[31];
var chanspec = '<%ejGetWl24G(wlCurrentChSpec)%>';            //
var nmode = AllwifiVarStrArr[32];
var nreqd = AllwifiVarStrArr[33];
var wmenoack= AllwifiVarStrArr[34];
var wmeapsd= AllwifiVarStrArr[35];
var nbwcap= AllwifiVarStrArr[36];
var haswme= AllwifiVarStrArr[37];
var globalmaxassoc= AllwifiVarStrArr[38];
var wep = AllwifiVarStrArr[39];
var WscVer2    = AllwifiVarStrArr[40];
var authmode = AllwifiVarStrArr[41];
var hide = AllwifiVarStrArr[42];
var WscMode = AllwifiVarStrArr[43];
var rxchain_pwrsave_enable = AllwifiVarStrArr[44];
var fburst =AllwifiVarStrArr[45];
var reg_mode = AllwifiVarStrArr[46];
var dfs_preism = AllwifiVarStrArr[47];
var dfs_postism = AllwifiVarStrArr[48];
var obsscoex = AllwifiVarStrArr[49];
var rifsadvert = AllwifiVarStrArr[50];

var syncNvram5 = AllwifiVarStrArr[51];
var enbl5 = AllwifiVarStrArr[52];
var country5 = AllwifiVarStrArr[53];
var channel5 = AllwifiVarStrArr[54];
var rate5 = AllwifiVarStrArr[55];
var frg5 = AllwifiVarStrArr[56];
var rts5 = AllwifiVarStrArr[57];
var dtm5 = AllwifiVarStrArr[58];
var bcn5 = AllwifiVarStrArr[59];
var phy5 = AllwifiVarStrArr[60];
var brate5 = AllwifiVarStrArr[61];
var gmode5 = AllwifiVarStrArr[62];
var pro5 = AllwifiVarStrArr[63];
var pre5 = AllwifiVarStrArr[64];
var band5 = AllwifiVarStrArr[65];
var mcastrate5 = AllwifiVarStrArr[66];
var hasafterburner5 = AllwifiVarStrArr[67];
var afterburneren5 = AllwifiVarStrArr[68];
var bands5 = AllwifiVarStrArr[69];
var mode5 = AllwifiVarStrArr[70];
var wlRefresh5 = AllwifiVarStrArr[71];
var TxPwrPcnt5 = AllwifiVarStrArr[72];
var reg_mode5 = AllwifiVarStrArr[73];
var dfs_preism5 = AllwifiVarStrArr[74];
var dfs_postism5 = AllwifiVarStrArr[75];
var tpcDb5 = AllwifiVarStrArr[76];
var wme5 = AllwifiVarStrArr[77];
var csscantimer5 = AllwifiVarStrArr[78];
var nctrlsb5 = AllwifiVarStrArr[79];
var corerev5 = AllwifiVarStrArr[80];
var npro5 = AllwifiVarStrArr[81];
var nmcsidx5 = AllwifiVarStrArr[82];
var chanspec5 = '<%ejGetWl5G(wlCurrentChSpec)%>';
var nmode5 = AllwifiVarStrArr[83];
var nreqd5 = AllwifiVarStrArr[84];
var wmenoack5 = AllwifiVarStrArr[85];
var wmeapsd5 = AllwifiVarStrArr[86];
var nbwcap5 = AllwifiVarStrArr[87];
var haswme5 = AllwifiVarStrArr[88];
var globalmaxassoc5 = AllwifiVarStrArr[89];
var wep5 = AllwifiVarStrArr[90];
var WscVer25    = AllwifiVarStrArr[91];
var authmode5 = AllwifiVarStrArr[92];
var hide5 = AllwifiVarStrArr[93];
var WscMode5 = AllwifiVarStrArr[94];
var rxchain_pwrsave_enable5 = AllwifiVarStrArr[95];
var fburst5 = AllwifiVarStrArr[96];
var reg_mode5 = AllwifiVarStrArr[97];
var dfs_preism5 = AllwifiVarStrArr[98];
var dfs_postism5 = AllwifiVarStrArr[99];
var obsscoex5 = AllwifiVarStrArr[100];
var rifsadvert5 = AllwifiVarStrArr[101];
var Device = AllwifiVarStrArr[102];

function getTpcDbIndex(val) {
   var ret;
   
   if ( val == "0" )
      ret = 0;
   else if ( val == "2" )
      ret = 1;
   else if ( val == "3" )
      ret = 2;
   else if ( val == "4" )
      ret = 3;
   else ret = 0;
   return ret;
}
function RegModeChange(OnPageLoad) {
   with ( document.forms[0] ) {
      var sel_band;
      
      sel_band = band;     
                
      if( wlRegMode.selectedIndex != 1 )
         wlDfsPreIsm.disabled=wlDfsPostIsm.disabled=wlTpcDb.disabled=true;
      else 
         wlDfsPreIsm.disabled=wlDfsPostIsm.disabled=wlTpcDb.disabled=false;
         
     if (sel_band == "2") {
        showhide("div_regMode", 0);   
     }
     else {
        showhide("div_regMode", 1);     
     }         
   } 
   
    with ( document.forms[1] ) {
      var sel_band;
      
      sel_band = band5;    
                
      if( wlRegMode.selectedIndex != 1 )
         wlDfsPreIsm.disabled=wlDfsPostIsm.disabled=wlTpcDb.disabled=true;
      else 
         wlDfsPreIsm.disabled=wlDfsPostIsm.disabled=wlTpcDb.disabled=false;
         
     if (sel_band == "2") {
        showhide("div_regMode5", 0);   
     }
     else {
        showhide("div_regMode5", 1);     
     }         
   }      
}

function gModeChange(idx, OnPageLoad) {
   with (document.forms[0]) {
      if (idx == 1) { // 54g auto
         wlPreamble.disabled = false;
         wlProtect.disabled = false;
      }
      else if (idx == 4) { // 54g performance
         wlPreamble.disabled = true;
         wlPreamble.selectedIndex = 1;
         wlProtect.disabled = false;
      }
      else if (idx == 0) { // b only
         wlPreamble.disabled = false;
         wlProtect.disabled = true;
         if (!OnPageLoad)
            wlProtect.selectedIndex = 0;
      }
   }
   with (document.forms[1]) {
      if (idx == 1) { // 54g auto
         wlPreamble.disabled = false;
         wlProtect.disabled = false;
      }
      else if (idx == 4) { // 54g performance
         wlPreamble.disabled = true;
         wlPreamble.selectedIndex = 1;
         wlProtect.disabled = false;
      }
      else if (idx == 0) { // b only
         wlPreamble.disabled = false;
         wlProtect.disabled = true;
         if (!OnPageLoad)
            wlProtect.selectedIndex = 0;
      }
   }   
   
}

function nModeChange(idx, OnPageLoad) {
   with (document.forms[0]) {
      if (idx == 0) { // 54g b only
         wlPreamble.disabled = false;
         wlProtect.disabled = true;
         if (!OnPageLoad)
            wlProtect.selectedIndex = 0;
      }
      else if (idx == 1) { // 54g performance
         wlPreamble.disabled = true;
         wlPreamble.selectedIndex = 1;
         wlProtect.disabled = false;
      }
      else if (idx == 3) { // 54g auto
         wlPreamble.disabled = false;
         wlProtect.disabled = false;
      }
      else if (idx == 2) { // 11n only
         wlPreamble.disabled = true;
         wlPreamble.selectedIndex = 0;
         wlProtect.disabled = false;
      }
      else if (idx == 4) { // 11b/g/n
         wlPreamble.disabled = true;
         wlPreamble.selectedIndex = 0;
         wlProtect.disabled = false;
      }
   }
   
    with (document.forms[1]) {
      if (idx == 0) { // 54g b only
         wlPreamble.disabled = false;
         wlProtect.disabled = true;
         if (!OnPageLoad)
            wlProtect.selectedIndex = 0;
      }
      else if (idx == 1) { // 54g performance
         wlPreamble.disabled = true;
         wlPreamble.selectedIndex = 1;
         wlProtect.disabled = false;
      }
      else if (idx == 3) { // 54g auto
         wlPreamble.disabled = false;
         wlProtect.disabled = false;
      }
      else if (idx == 2) { // 11n only
         wlPreamble.disabled = true;
         wlPreamble.selectedIndex = 0;
         wlProtect.disabled = false;
      }
      else if (idx == 4) { // 11b/g/n
         wlPreamble.disabled = true;
         wlPreamble.selectedIndex = 0;
         wlProtect.disabled = false;
      }
   }  
}

function n_acModeChange(idx, OnPageLoad) {
   with (document.forms[0]) {
      if (idx == 0) { // a only
         wlPreamble.disabled = true;
         wlPreamble.selectedIndex = 1;
         wlProtect.disabled = false;
      }
      else{ // 
         wlPreamble.disabled = true;
         wlPreamble.selectedIndex = 0;
         wlProtect.disabled = false;
      }

   }
   
   with (document.forms[1]) {
      if (idx == 0) { // a only
         wlPreamble.disabled = true;
         wlPreamble.selectedIndex = 1;
         wlProtect.disabled = false;
      }
      else{ // 
         wlPreamble.disabled = true;
         wlPreamble.selectedIndex = 0;
         wlProtect.disabled = false;
      }

   } 
   
}

function wlModeChange(OnPageLoad) {
   with (document.forms[0]) {
      if (OnPageLoad) {

         if (phy == 'n') {
            if (nmode == 'off' && gmode == '0') { // 54g b only
               wlMode.selectedIndex = 0;
            }
            else if (nmode == 'off' && gmode == '4') { // 54g performance
               wlMode.selectedIndex = 1;
            }
            else if (nmode == 'off' && gmode == '1') { // 54g auto
               wlMode.selectedIndex = 3;
            }
            else if (nmode == 'auto' && nreqd == '1') { // 11n only
               wlMode.selectedIndex = 2;
            }
            else if (nmode == 'auto' && nreqd == '0') { // 11b/g/n
               wlMode.selectedIndex = 4;
            }

            if (nmode == 'auto')
               document.forms[0].wlProtect.value = npro;
            else
               document.forms[0].wlProtect.value = pro;

            nModeChange(wlMode.selectedIndex, OnPageLoad);
         }else if (phy == 'v'){
           if (nmode == 'off') { //  a mode 
                 wlMode.selectedIndex = 0;
			  }else if( nmode == 'auto' && nreqd == '0' && nbwcap != '3'){
			  	 wlMode.selectedIndex = 1;
			  }else if( nmode == 'auto' && nreqd == '1' && nbwcap != '3'){
			  	 wlMode.selectedIndex = 2;
			  }else if( nmode == 'auto' && nreqd == '0'  && nbwcap == '3'){
			  	 wlMode.selectedIndex = 3;
			  }else if( nmode == 'auto' && nreqd == '1'  && nbwcap == '3'){
				wlMode.selectedIndex = 4;
			  }
            if (nmode == 'auto')
               document.forms[0].wlProtect.value = npro;
            else
               document.forms[0].wlProtect.value = pro;

           n_acModeChange(wlMode.selectedIndex, OnPageLoad);
         } else {
            if (gmode == '0') {
               wlMode.selectedIndex = 0;
            }
            else if (gmode == '1') {
               wlMode.selectedIndex = 2;
            }
            else if (gmode == '4') {
               wlMode.selectedIndex = 1;
            }

            document.forms[0].wlProtect.value = pro;
            gModeChange(wlMode.options[wlMode.selectedIndex].value, OnPageLoad);
         }
      }
      else {
         var sel_mode;
         sel_mode = wlMode.options[wlMode.selectedIndex].value;

         if (phy == 'n') {
            nModeChange(sel_mode, OnPageLoad);
         }else if (phy == 'v'){
            n_acModeChange(sel_mode, OnPageLoad);
         }else {
            gModeChange(sel_mode, OnPageLoad);
         }
      }

      // loadMCastRateList(false);
   }
   
    with (document.forms[1]) {
      if (OnPageLoad) {

         if (phy5 == 'n') {
            if (nmode5 == 'off' && gmode5 == '0') { // 54g b only
               wlMode.selectedIndex = 0;
            }
            else if (nmode5 == 'off' && gmode5 == '4') { // 54g performance
               wlMode.selectedIndex = 1;
            }
            else if (nmode5 == 'off' && gmode5 == '1') { // 54g auto
               wlMode.selectedIndex = 3;
            }
            else if (nmode5 == 'auto' && nreqd5 == '1') { // 11n only
               wlMode.selectedIndex = 2;
            }
            else if (nmode5 == 'auto' && nreqd5 == '0') { // 11b/g/n
               wlMode.selectedIndex = 4;
            }

            if (nmode == 'auto')
               document.forms[1].wlProtect.value = npro5;
            else
               document.forms[1].wlProtect.value = pro5;

            nModeChange(wlMode.selectedIndex, OnPageLoad);
         }else if (phy5 == 'v'){
           if (nmode5 == 'off') { //  a mode 
                 wlMode.selectedIndex = 0;
			  }else if( nmode5 == 'auto' && nreqd5 == '0' && nbwcap5 != '3'){
			  	 wlMode.selectedIndex = 1;
			  }else if( nmode5 == 'auto' && nreqd5 == '1' && nbwcap5 != '3'){
			  	 wlMode.selectedIndex = 2;
			  }else if( nmode5 == 'auto' && nreqd5 == '0'  && nbwcap5 == '3'){
			  	 wlMode.selectedIndex = 3;
			  }else if( nmode5 == 'auto' && nreqd5 == '1'  && nbwcap5 == '3'){
				wlMode.selectedIndex = 4;
			  }
            if (nmode == 'auto')
               document.forms[1].wlProtect.value = npro5;
            else
               document.forms[1].wlProtect.value = pro5;

           n_acModeChange(wlMode.selectedIndex, OnPageLoad);
         } else {
            if (gmode5 == '0') {
               wlMode.selectedIndex = 0;
            }
            else if (gmode5 == '1') {
               wlMode.selectedIndex = 2;
            }
            else if (gmode5 == '4') {
               wlMode.selectedIndex = 1;
            }

            document.forms[1].wlProtect.value = pro5;
            gModeChange(wlMode.options[wlMode.selectedIndex].value, OnPageLoad);
         }
      }
      else {
         var sel_mode;
         sel_mode = wlMode.options[wlMode.selectedIndex].value;

         if (phy5 == 'n') {
            nModeChange(sel_mode, OnPageLoad);
         }else if (phy5 == 'v'){
            n_acModeChange(sel_mode, OnPageLoad);
         }else {
            gModeChange(sel_mode, OnPageLoad);
         }
      }

      // loadMCastRateList(false);
   }  
   
}
function getFrameBurstIndex(frameburst) {
   var ret;

   if ( frameburst == "off" )
      ret = 0;
   else
      ret = 1;
   return ret;
}
function frmLoad() {
	// if QTN is support and 5g is selected
   if(forTDCQTN == 1 && Device == 1) {
		with ( document.forms[0] ) {
			$("#24G_other").hide();

			extWlDtmIntvl.value = extDtm;
			extWlBcnIntvl.value = extBcn;
		}
   } else {
   with ( document.forms[0] ) {
	  $("#5G_other").hide();
   
      wlFrgThrshld.value = frg;
      wlRtsThrshld.value = rts;
      wlCsScanTimer.value = csscantimer;
      // wlGlobalMaxAssoc.value = globalmaxassoc;
      wlTxPwrPcnt.selectedIndex = ((TxPwrPcnt/20) -1);
      wlDtmIntvl.value = dtm;
      wlBcnIntvl.value = bcn;
	  wlFrameBurst.selectedIndex = getFrameBurstIndex(fburst);
	  wlRxChainPwrSaveEnable.value = rxchain_pwrsave_enable;
      wlRegMode.selectedIndex = reg_mode;
      wlDfsPreIsm.value = dfs_preism;
      wlDfsPostIsm.value = dfs_postism;
      wlTpcDb.selectedIndex = getTpcDbIndex(tpcDb);
      wlObssCoex.value = obsscoex;
	  wlRifsAdvert.selectedIndex = (rifsadvert == "-1" ? 1 : 0);
	  /*Remove ACS policy menu from GUI. : Peter.Lee.MitraStar 2012-08-01*/
	  //acs_policy.selectedIndex = acs_pol;
	 
		if (forNorway == '1'){
			document.getElementById("wlmodeTable").style.display="none";
		}

      if (WscVer2 == 'enabled') {
         wlwscver2.checked = true;
      } else {
         wlwscver2.checked = false;
      }	  

/*button disable with WPS state : Peter.Lee.MitraStar 2012-07-25*/
/*      if (WscMode == 'enabled') {
         wlwscver2.disabled = false;
      } else {
         wlwscver2.disabled = true;
      }	  
*/
	  
      /* preamble */
      if ( pre == 'short' ) {
         wlPreamble.selectedIndex = 1;
      }
      else {
         wlPreamble.selectedIndex = 0;    
      }

      wlModeChange(true);
      RegModeChange(true);
      // loadMCastRateList(true);
      if (channel == '0')
         wlCsScanTimer.disabled = false;
      else
         wlCsScanTimer.disabled = true;
	}
	
   with ( document.forms[1] ) {
	  $("#5G_other").hide();
   
      wlFrgThrshld.value = frg5;
      wlRtsThrshld.value = rts5;
      wlCsScanTimer.value = csscantimer5;
      // wlGlobalMaxAssoc.value = globalmaxassoc;
      wlTxPwrPcnt.selectedIndex = ((TxPwrPcnt5/20) -1);
      wlDtmIntvl.value = dtm5;
      wlBcnIntvl.value = bcn5;
	  wlFrameBurst.selectedIndex = getFrameBurstIndex(fburst5);
	  wlRxChainPwrSaveEnable.value = rxchain_pwrsave_enable5;
      wlRegMode.selectedIndex = reg_mode5;
      wlDfsPreIsm.value = dfs_preism5;
      wlDfsPostIsm.value = dfs_postism5;
      wlTpcDb.selectedIndex = getTpcDbIndex(tpcDb5);
      wlObssCoex.value = obsscoex5;
	  wlRifsAdvert.selectedIndex = (rifsadvert5 == "-1" ? 1 : 0);
	  /*Remove ACS policy menu from GUI. : Peter.Lee.MitraStar 2012-08-01*/
	  //acs_policy.selectedIndex = acs_pol;
	  
		if (forNorway == '1'){			
			document.getElementById("wlmodeTable2").style.display="none";
		}	

      if (WscVer25 == 'enabled') {
         wlwscver2.checked = true;
      } else {
         wlwscver2.checked = false;
      }	  

/*button disable with WPS state : Peter.Lee.MitraStar 2012-07-25*/
/*      if (WscMode == 'enabled') {
         wlwscver2.disabled = false;
      } else {
         wlwscver2.disabled = true;
      }	  
*/
	  
      /* preamble */
      if ( pre5 == 'short' ) {
         wlPreamble.selectedIndex = 1;
      }
      else {
         wlPreamble.selectedIndex = 0;    
      }

      wlModeChange(true);
      RegModeChange(true);
      // loadMCastRateList(true);
      if (channel5 == '0')
         wlCsScanTimer.disabled = false;
      else
         wlCsScanTimer.disabled = true;


   	}
   }

   	if (errMsg != '')
	{
		hciAlert(errMsg, 2);
	}
}

function btnApply() {
   // if QTN is support and 5g is selected
   if(forTDCQTN == 1 && Device == 1) {
		with ( document.forms[0] ) {
			sessionKey.value = sessionkey;
			
			var dtmNum = parseInt(extWlDtmIntvl.value);
			if ( isNaN(dtmNum) == true || dtmNum < 1 || dtmNum > 15 ) {
				// alert('DTIM interval "' + wlDtmIntvl.value + '" should be between 1 and 15.');
				msg = MLG_Makestring("<%ejGetML(MLG_WLAN_Advanced_AlertMsg_Str6)%>", wlDtmIntvl.value);
				hciAlert(msg, {height: 180, type: 2, title: '<%ejGetML(MLG_WLAN_AlertMsg_Alert)%>'});
				return false;
			}

			bcnNum = parseInt(extWlBcnIntvl.value);
			if ( isNaN(bcnNum) == true || bcnNum < 50 || bcnNum > 1000 ) { // 1~65535 for valid range, 50~1000 for configuration range
			// alert('Beacon interval "' + wlBcnIntvl.value + '" should be between 50 and 1000.');
				msg = MLG_Makestring("<%ejGetML(MLG_WLAN_Advanced_AlertMsg_Str4)%>",  wlBcnIntvl.value);
				hciAlert(msg, {height: 180, type: 2, title: '<%ejGetML(MLG_WLAN_AlertMsg_Alert)%>'});
				return;
			}			
		}
   } else {
   with ( document.forms[0] ) {
      sessionKey.value = sessionkey;
	  deviceIndex.value = 0;

      var msg = "";
      var rtsNum=parseInt(wlRtsThrshld.value);
      if ( isNaN(rtsNum) == true || rtsNum < 0 || rtsNum > 2347 ) {
         // alert('RTS threshold "' + wlRtsThrshld.value + '" should be between 0 and 2347.');
         msg = MLG_Makestring("<%ejGetML(MLG_WLAN_Advanced_AlertMsg_Str1)%>", wlRtsThrshld.value);
         hciAlert(msg, {height: 180, type: 2, title: '<%ejGetML(MLG_WLAN_AlertMsg_Alert)%>'});
         return false;
      }
                
      var frgNum = parseInt(wlFrgThrshld.value);
      if ( isNaN(frgNum) == true || frgNum < 256 || frgNum > 2346 ) {
         // alert('Fragmentation threshold "' + wlFrgThrshld.value + '" should be between 256 and 2346.');
         msg = MLG_Makestring("<%ejGetML(MLG_WLAN_Advanced_AlertMsg_Str2)%>", wlFrgThrshld.value);
         hciAlert(msg, {height: 180, type: 2, title: '<%ejGetML(MLG_WLAN_AlertMsg_Alert)%>'});
         return false;
      }
/*
      var globalMaxAssocNum = parseInt(wlGlobalMaxAssoc.value);
      if ( isNaN(globalMaxAssocNum) == true || globalMaxAssocNum < 1 || globalMaxAssocNum > 123 ) {
         alert('Global Max Clients: "' + wlGlobalMaxAssoc.value + '" should be between 1 and 123.');
         return false;
      }

      wlMaxAssoc_wl0v0.value = wlGlobalMaxAssoc.value;
      wlMaxAssoc_wl0v1.value = wlGlobalMaxAssoc.value;
      wlMaxAssoc_wl0v2.value = wlGlobalMaxAssoc.value;
      wlMaxAssoc_wl0v3.value = wlGlobalMaxAssoc.value;
*/
      var dtmNum = parseInt(wlDtmIntvl.value);
      if ( isNaN(dtmNum) == true || dtmNum < 1 || dtmNum > 15 ) {
         // alert('DTIM interval "' + wlDtmIntvl.value + '" should be between 1 and 15.');
         msg = MLG_Makestring("<%ejGetML(MLG_WLAN_Advanced_AlertMsg_Str3)%>", wlDtmIntvl.value);
         hciAlert(msg, {height: 180, type: 2, title: '<%ejGetML(MLG_WLAN_AlertMsg_Alert)%>'});
         return false;
      }

      bcnNum = parseInt(wlBcnIntvl.value);
      if ( isNaN(bcnNum) == true || bcnNum < 50 || bcnNum > 1000 ) { // 1~65535 for valid range, 50~1000 for configuration range
         // alert('Beacon interval "' + wlBcnIntvl.value + '" should be between 1 and 65535.');
         msg = MLG_Makestring("<%ejGetML(MLG_WLAN_Advanced_AlertMsg_Str4)%>",  wlBcnIntvl.value);
         hciAlert(msg, {height: 180, type: 2, title: '<%ejGetML(MLG_WLAN_AlertMsg_Alert)%>'});
         return;
      }

     if(wlRegMode.selectedIndex == 1) {
        DfsPreIsmNum = parseInt(wlDfsPreIsm.value);
        if ( isNaN(DfsPreIsmNum) == true || DfsPreIsmNum < 0 || DfsPreIsmNum > 99 ) {
           //alert('Pre-Network Radar Check "' + wlDfsPreIsm.value + '" should be between 0 and 99.');
         msg = MLG_Makestring("<%ejGetML(MLG_WLAN_Advanced_AlertMsg_11ac_Str1)%>",  wlDfsPreIsm.value);
         hciAlert(msg, {height: 180, type: 2, title: '<%ejGetML(MLG_WLAN_AlertMsg_Alert)%>'});
           return;
        }
      
        DfsPostNum = parseInt(wlDfsPostIsm.value);
        if ( isNaN(DfsPostNum) == true || DfsPostNum < 10 || DfsPostNum > 99 ) {
          // alert('In-Network Radar Check: "' + wlDfsPostIsm.value + '" should be between 10 and 99.');
         msg = MLG_Makestring("<%ejGetML(MLG_WLAN_Advanced_AlertMsg_11ac_Str2)%>",  wlDfsPostIsm.value);
         hciAlert(msg, {height: 180, type: 2, title: '<%ejGetML(MLG_WLAN_AlertMsg_Alert)%>'});
           return;
        } 
     }  
	 
      if(wep == 'enabled' && wlMode.selectedIndex == 2){
         hciAlert("<%ejGetML(MLG_WLAN_Advanced_AlertMsg_Str5)%> <a href=\"#\" onClick= \"$('.ui-dialog-titlebar-close').trigger('click'); window.parent.document.activePage('network-wireless', 0);\"><%ejGetML(MLG_Common_General)%></a> <%ejGetML(MLG_WLAN_WPS_AlertMsg_page)%>.", {height: 180, type: 2, title: ''});
         return;
      }

      if (wlwscver2.checked == true) {
		 	wlWscVer2.value = "enabled";
      }else{
		 	wlWscVer2.value = "disabled";
      }	  
	  /* Do not submit to httpd */
	  wlwscver2.disabled = true;
	  
      var wl_mode = wlMode.selectedIndex;
	      if (phy == 'n' && (wl_mode == 2 || wl_mode == 4)) { // n or b/g/n
	         wlNmode.value = 'auto';
	         wlgMode.disabled = true;
	         wlProtection.disabled = true;
	         wlBasicRate.disabled = true;
	         wlPreambleType.disabled = true;
	         wlNBwCap.disabled = true;

	         if (wl_mode == 2) {
	            wlNReqd.value = '1';
	         }
	         else {
	            wlNReqd.value = '0';
	         }

	         wlWme.value = '1';
	         wlNProtection.value = wlProtect.options[wlProtect.selectedIndex].value;
	      }else if(phy == 'v' && wl_mode != 0){
	         wlNmode.value = 'auto';
	         wlgMode.disabled = true;
	         wlProtection.disabled = true;
	         wlBasicRate.disabled = true;
	         wlPreambleType.disabled = true;

	         if (wl_mode == 2 || wl_mode == 4) {
	            wlNReqd.value = '1';
	         }
	         else {
	            wlNReqd.value = '0';
	         }

			 if(wl_mode == 3 || wl_mode == 4){
				wlNBwCap.value = '3'; //11ac bandwith=80M
			 }else{
			wlNBwCap.disabled = true;  
		 }

	         wlWme.value = '1';
	         wlNProtection.value = wlProtect.options[wlProtect.selectedIndex].value;
	      
	      }
	      else { // b/g, b, or g
	         wlNmode.value = 'off';
		 wlNBwCap.value = '0'; //disable n_mode
	         wlNReqd.disabled = true;
	         wlNProtection.disabled = true;
	         wlWme.disabled = true;
	         if (phy == 'n') {
	            if (wl_mode == 0) { // 11b only
	               wlgMode.value = "0";
	               wl_mode = 0;
	            } 
	            else if (wl_mode == 1) { // 11g only
	               wlgMode.value = "4";
	               wl_mode = 1;
	            }
	            else if (wl_mode == 3) { // b/g
	               wlgMode.value = "1";
	               wl_mode = 2;
	            }
	         }else if(phy == 'v'){
	              if (wl_mode == 0) { // 11a only
	               wlgMode.value = "1";
	               wl_mode = 2;
	            } 
	         
	         }
	         else {
	            wlgMode.value = wlMode.options[wlMode.selectedIndex].value;
	         }
	         wlPreambleType.value = wlPreamble.options[wlPreamble.selectedIndex].value;

	         /* basic rate */
	         if (wl_mode == 2) // 54g auto
	            wlBasicRate.value = 'default';
	         else if (wl_mode == 1) // 54 performance
	            wlBasicRate.value = 'wifi2';
	         else if (wl_mode == 0) // 54g b only
	            wlBasicRate.value = '12';

	         if (band == '2') {//2.4
	            if (phy != 'b') {
	               wlProtection.value = wlProtect.options[wlProtect.selectedIndex].value;
	            } else
	               wlProtection.disabled = true;
	         }
	         else //5G
	            wlProtection.value = 'auto';
	      }

	  	  wlProtect.disabled = true;
	      wlPreamble.disabled = true;
	      wlMode.disabled = true;
	  	var wl_nvram = document.createElement("input");
		wl_nvram.type = "hidden";
		wl_nvram.size = "15";
		wl_nvram.name = "wlSyncNvram";
		wl_nvram.value = "1";
		document.forms[0].appendChild(wl_nvram);
   }
   with ( document.forms[1] ) {
      sessionKey.value = sessionkey;
	  deviceIndex.value = 1; //5g
	  
      var msg = "";
      var rtsNum=parseInt(wlRtsThrshld.value);
      if ( isNaN(rtsNum) == true || rtsNum < 0 || rtsNum > 2347 ) {
         // alert('RTS threshold "' + wlRtsThrshld.value + '" should be between 0 and 2347.');
         msg = MLG_Makestring("<%ejGetML(MLG_WLAN_Advanced_AlertMsg_Str1)%>", wlRtsThrshld.value);
         hciAlert(msg, {height: 180, type: 2, title: '<%ejGetML(MLG_WLAN_AlertMsg_Alert)%>'});
         return false;
      }
                
      var frgNum = parseInt(wlFrgThrshld.value);
      if ( isNaN(frgNum) == true || frgNum < 256 || frgNum > 2346 ) {
         // alert('Fragmentation threshold "' + wlFrgThrshld.value + '" should be between 256 and 2346.');
         msg = MLG_Makestring("<%ejGetML(MLG_WLAN_Advanced_AlertMsg_Str2)%>", wlFrgThrshld.value);
         hciAlert(msg, {height: 180, type: 2, title: '<%ejGetML(MLG_WLAN_AlertMsg_Alert)%>'});
         return false;
      }
/*
      var globalMaxAssocNum = parseInt(wlGlobalMaxAssoc.value);
      if ( isNaN(globalMaxAssocNum) == true || globalMaxAssocNum < 1 || globalMaxAssocNum > 123 ) {
         alert('Global Max Clients: "' + wlGlobalMaxAssoc.value + '" should be between 1 and 123.');
         return false;
      }

      wlMaxAssoc_wl0v0.value = wlGlobalMaxAssoc.value;
      wlMaxAssoc_wl0v1.value = wlGlobalMaxAssoc.value;
      wlMaxAssoc_wl0v2.value = wlGlobalMaxAssoc.value;
      wlMaxAssoc_wl0v3.value = wlGlobalMaxAssoc.value;
*/
      var dtmNum = parseInt(wlDtmIntvl.value);
      if ( isNaN(dtmNum) == true || dtmNum < 1 || dtmNum > 15 ) {
         // alert('DTIM interval "' + wlDtmIntvl.value + '" should be between 1 and 15.');
         msg = MLG_Makestring("<%ejGetML(MLG_WLAN_Advanced_AlertMsg_Str3)%>", wlDtmIntvl.value);
         hciAlert(msg, {height: 180, type: 2, title: '<%ejGetML(MLG_WLAN_AlertMsg_Alert)%>'});
         return false;
      }

      bcnNum = parseInt(wlBcnIntvl.value);
      if ( isNaN(bcnNum) == true || bcnNum < 50 || bcnNum > 1000 ) { // 1~65535 for valid range, 50~1000 for configuration range
         // alert('Beacon interval "' + wlBcnIntvl.value + '" should be between 1 and 65535.');
         msg = MLG_Makestring("<%ejGetML(MLG_WLAN_Advanced_AlertMsg_Str4)%>",  wlBcnIntvl.value);
         hciAlert(msg, {height: 180, type: 2, title: '<%ejGetML(MLG_WLAN_AlertMsg_Alert)%>'});
         return;
      }

     if(wlRegMode.selectedIndex == 1) {
        DfsPreIsmNum = parseInt(wlDfsPreIsm.value);
        if ( isNaN(DfsPreIsmNum) == true || DfsPreIsmNum < 0 || DfsPreIsmNum > 99 ) {
           //alert('Pre-Network Radar Check "' + wlDfsPreIsm.value + '" should be between 0 and 99.');
         msg = MLG_Makestring("<%ejGetML(MLG_WLAN_Advanced_AlertMsg_11ac_Str1)%>",  wlDfsPreIsm.value);
         hciAlert(msg, {height: 180, type: 2, title: '<%ejGetML(MLG_WLAN_AlertMsg_Alert)%>'});
           return;
        }
      
        DfsPostNum = parseInt(wlDfsPostIsm.value);
        if ( isNaN(DfsPostNum) == true || DfsPostNum < 10 || DfsPostNum > 99 ) {
          // alert('In-Network Radar Check: "' + wlDfsPostIsm.value + '" should be between 10 and 99.');
         msg = MLG_Makestring("<%ejGetML(MLG_WLAN_Advanced_AlertMsg_11ac_Str2)%>",  wlDfsPostIsm.value);
         hciAlert(msg, {height: 180, type: 2, title: '<%ejGetML(MLG_WLAN_AlertMsg_Alert)%>'});
           return;
        } 
     }  
	 
      if(wep == 'enabled' && wlMode.selectedIndex == 2){
         hciAlert("<%ejGetML(MLG_WLAN_Advanced_AlertMsg_Str5)%> <a href=\"#\" onClick= \"$('.ui-dialog-titlebar-close').trigger('click'); window.parent.document.activePage('network-wireless', 0);\"><%ejGetML(MLG_Common_General)%></a> <%ejGetML(MLG_WLAN_WPS_AlertMsg_page)%>.", {height: 180, type: 2, title: ''});
         return;
      }

      if (wlwscver2.checked == true) {
		 	wlWscVer2.value = "enabled";
      }else{
		 	wlWscVer2.value = "disabled";
      }	  
	  /* Do not submit to httpd */
	  wlwscver2.disabled = true;
	  
      var wl_mode = wlMode.selectedIndex;
      if (phy5 == 'n' && (wl_mode == 2 || wl_mode == 4)) { // n or b/g/n
         wlNmode.value = 'auto';
         wlgMode.disabled = true;
         wlProtection.disabled = true;
         wlBasicRate.disabled = true;
         wlPreambleType.disabled = true;
         wlNBwCap.disabled = true;
		 

         if (wl_mode == 2) {
            wlNReqd.value = '1';
         }
         else {
            wlNReqd.value = '0';
         }

         wlWme.value = '1';
         wlNProtection.value = wlProtect.options[wlProtect.selectedIndex].value;
      }else if(phy5 == 'v' && wl_mode != 0){
         wlNmode.value = 'auto';
         wlgMode.disabled = true;
         wlProtection.disabled = true;
         wlBasicRate.disabled = true;
         wlPreambleType.disabled = true;

         if (wl_mode == 2 || wl_mode == 4) {
            wlNReqd.value = '1';
         }
         else {
            wlNReqd.value = '0';
         }

		 if(wl_mode == 3 || wl_mode == 4){
			wlNBwCap.value = '3'; //11ac bandwith=80M
		 }else{
			wlNBwCap.disabled = true;  
		 }
		 
         wlWme.value = '1';
         wlNProtection.value = wlProtect.options[wlProtect.selectedIndex].value;
      
      }
      else { // b/g, b, or g
         wlNmode.value = 'off';
	 wlNBwCap.value = '0'; //disable n_mode
         wlNReqd.disabled = true;
         wlNProtection.disabled = true;
         wlWme.disabled = true;
         if (phy5 == 'n') {
            if (wl_mode == 0) { // 11b only
               wlgMode.value = "0";
               wl_mode = 0;
            } 
            else if (wl_mode == 1) { // 11g only
               wlgMode.value = "4";
               wl_mode = 1;
            }
            else if (wl_mode == 3) { // b/g
               wlgMode.value = "1";
               wl_mode = 2;
            }
         }else if(phy5 == 'v'){
              if (wl_mode == 0) { // 11a only
               wlgMode.value = "1";
               wl_mode = 2;
            } 
         
         }
         else {
            wlgMode.value = wlMode.options[wlMode.selectedIndex].value;
         }
         wlPreambleType.value = wlPreamble.options[wlPreamble.selectedIndex].value;

         /* basic rate */
         if (wl_mode == 2) // 54g auto
            wlBasicRate.value = 'default';
         else if (wl_mode == 1) // 54 performance
            wlBasicRate.value = 'wifi2';
         else if (wl_mode == 0) // 54g b only
            wlBasicRate.value = '12';

         if (band == '2') {//2.4
            if (phy5 != 'b') {
               wlProtection.value = wlProtect.options[wlProtect.selectedIndex].value;
            } else
               wlProtection.disabled = true;
         }
         else //5G
            wlProtection.value = 'auto';
      }

      wlProtect.disabled = true;
      wlPreamble.disabled = true;
      wlMode.disabled = true;
	  	var wl_nvram = document.createElement("input");
		wl_nvram.type = "hidden";
		wl_nvram.size = "15";
		wl_nvram.name = "wlSyncNvram";
		wl_nvram.value = "1";
		document.forms[1].appendChild(wl_nvram);
   }   
   
	}
   return true;
}


/* Protection for WPS2.0 with WEP , __TELEFONICA__, MitraStar Curtis, 20120410 */
function WPS2Check(onLoadPage) {
   with (document.forms[0]) {		
		 	if(wlwscver2.checked==true){
				
/*We place here for rapidly response : Peter.Lee.MitraStar 2012-07-25*/
				if(authmode == "psk" && WscMode == "enabled")  	{
		        	 hciAlert("WPS-PSK not supoort on WPS2.0. You should change security in <a href=\"#\" onClick= \"$('.ui-dialog-titlebar-close').trigger('click'); window.parent.document.activePage('network-wireless', 0);\">General</a> page.", {height: 180, type: 2, title: 'Error'});
			       wlwscver2.checked=false;
			  	}

			  	if(hide == "1")  	{
		        	 hciAlert("Hide SSID does not support on WPS 2.0. You should change configure in <a href=\"#\" onClick= \"$('.ui-dialog-titlebar-close').trigger('click'); window.parent.document.activePage('network-wireless', 0);\">General</a> page.", {height: 180, type: 2, title: 'Error'});
			       wlwscver2.checked=false;
			  	}		
			}

   }
   
   with (document.forms[1]) {		
		 	if(wlwscver2.checked==true){
				
/*We place here for rapidly response : Peter.Lee.MitraStar 2012-07-25*/
				if(authmode == "psk" && WscMode == "enabled")  	{
		        	 hciAlert("WPS-PSK not supoort on WPS2.0. You should change security in <a href=\"#\" onClick= \"$('.ui-dialog-titlebar-close').trigger('click'); window.parent.document.activePage('network-wireless', 0);\">General</a> page.", {height: 180, type: 2, title: 'Error'});
			       wlwscver2.checked=false;
			  	}

			  	if(hide == "1")  	{
		        	 hciAlert("Hide SSID does not support on WPS 2.0. You should change configure in <a href=\"#\" onClick= \"$('.ui-dialog-titlebar-close').trigger('click'); window.parent.document.activePage('network-wireless', 0);\">General</a> page.", {height: 180, type: 2, title: 'Error'});
			       wlwscver2.checked=false;
			  	}		
			}

   }   
   
   
}

function doSubmit0() {
   if (btnApply()) {
      document.forms[0].submit();
      $.openLoadingMask(1);
   }
}

function doSubmit1() {
   if (btnApply()) {
      document.forms[1].submit();
      $.openLoadingMask(1);
   }
}

// done hiding -->
</script>
<div class="content_frame">
   <form action="/pages/tabFW/wireless-others.wl" method="post" onSubmit="return btnApply();">
   <input size="15" type="hidden" name="deviceIndex" />
<!--Unit Explain start-->
         <div class="explain">
            <div>
               <b class="r1"></b>
               <b class="r2"></b>
               <b class="r3"></b>
               <b class="r4"></b>
               <b class="r4"></b>
            </div>
            <div class="explain_text"><%ejGetML(MLG_WLAN_Advanced_Str1)%></div>
            <div>
               <b class="r4"></b>
               <b class="r4"></b>
               <b class="r3"></b>
               <b class="r2"></b>
               <b class="r1"></b>
            </div>
         </div>
<!--Unit Explain End-->
<div class="data_frame"><ul>
<!--level 1 title start-->
            <li class="title">2.4G <%ejGetML(MLG_WLAN_Advanced_Str2)%></li>
<!--level 1 title end-->
<li class="set1">
    <div class="w_text" id="24G_other">
                  <ul>
                     <li class="left_table"><%ejGetML(MLG_WLAN_Advanced_Str3)%> :</li>
                     <li class="right_table">
                        <input type='text' name='wlRtsThrshld' maxlength="5" size="5">
                     </li>
                  </ul>
                  <ul>
                     <li class="left_table"><%ejGetML(MLG_WLAN_Advanced_Str4)%> :</li>
                     <li class="right_table">
                        <input type='text' name='wlFrgThrshld' maxlength="5" size="5">
                     </li>
                  </ul>
                  <ul>
                     <li class="left_table"><%ejGetML(MLG_WLAN_Advanced_Str5)%> :</li>
                     <li class="right_table">
                        <input type='text' name='wlCsScanTimer' maxlength="5" size="5"> <%ejGetML(MLG_WLAN_Advanced_Str6)%> </li>
                  </ul>
                  <ul>
                     <li class="left_table"><%ejGetML(MLG_WLAN_Advanced_Str8)%> :</li>
                     <li class="right_table">
                        <select name="wlTxPwrPcnt" size="1">
                           <option value="20">20%</option>
                           <option value="40">40%</option>
                           <option value="60">60%</option>
                           <option value="80">80%</option>
                           <option value="100">100%</option>
                        </select>
                     </li>
                  </ul>
                  <ul>
                     <li class="left_table"><%ejGetML(MLG_WLAN_Advanced_Str9)%> :</li>
                     <li class="right_table">
                        <input type='text' name='wlBcnIntvl' maxlength="5" size="5">&nbsp;<%ejGetML(MLG_WLAN_Advanced_Str7)%> </li>
                  </ul>
                  <ul>
                     <li class="left_table"><%ejGetML(MLG_WLAN_Advanced_Str10)%> :</li>
                     <li class="right_table">
                        <input type='text' name='wlDtmIntvl' maxlength="5" size="5">&nbsp;<%ejGetML(MLG_WLAN_Advanced_Str7)%></li>
                  </ul>                  
                  <ul id="wlmodeTable">
                     <li class="left_table"><%ejGetML(MLG_WLAN_BasicWirelessSetup_Str18)%> :</li>
                     <li class="right_table">
                        <select name="wlMode" size='1'onChange="wlModeChange(false);">
                          <script language="javascript">
                          <!-- hide
                             if ( phy == 'n') {
                                document.forms[0].wlMode[0] = new Option("<%ejGetML(MLG_Common_80211b)%>", "0");
                                document.forms[0].wlMode[1] = new Option("<%ejGetML(MLG_Common_80211g)%>", "1");
                                document.forms[0].wlMode[2] = new Option("<%ejGetML(MLG_Common_80211n)%>", "2");
                                document.forms[0].wlMode[3] = new Option("<%ejGetML(MLG_Common_80211bg)%>", "3");
                                document.forms[0].wlMode[4] = new Option("<%ejGetML(MLG_Common_80211bgn)%>", "4");
                             }else if( phy == 'v' ){
                                document.forms[0].wlMode[0] = new Option("<%ejGetML(MLG_Common_80211a)%>", "0");
                                document.forms[0].wlMode[1] = new Option("<%ejGetML(MLG_Common_80211an)%>", "1");
                                document.forms[0].wlMode[2] = new Option("<%ejGetML(MLG_Common_80211n)%>", "2");
                                document.forms[0].wlMode[3] = new Option("<%ejGetML(MLG_Common_80211anac)%>", "3");
                                document.forms[0].wlMode[4] = new Option("<%ejGetML(MLG_Common_80211nac)%>", "4");
                             }
                             else {
                                document.forms[0].wlMode[0] = new Option("<%ejGetML(MLG_Common_80211b)%>", "0");
                                document.forms[0].wlMode[1] = new Option("<%ejGetML(MLG_Common_80211g)%>", "4");
                                document.forms[0].wlMode[2] = new Option("<%ejGetML(MLG_Common_80211bg)%>", "1");
                             }
                          // done hiding -->
                          </script>
                        </select>
                     </li>
                  </ul>                  
                  <ul>
                     <li class="left_table"><%ejGetML(MLG_WLAN_BasicWirelessSetup_Str19)%> :</li>
                     <li class="right_table">
                        <select name="wlProtect" size="1">
                           <option value="off"><%ejGetML(MLG_Common_Off)%></option>
                           <option value="auto"><%ejGetML(MLG_Common_Auto)%></option>
                        </select>
                     </li>
                  </ul>
                  <ul>
                     <li class="left_table"><%ejGetML(MLG_WLAN_BasicWirelessSetup_Str20)%> :</li>
                     <li class="right_table">
                        <select name="wlPreamble" size="1">
                           <option value="long"><%ejGetML(MLG_Common_Long)%></option>
                           <option value="short"><%ejGetML(MLG_Common_Short)%></option>
                        </select>
                     </li>
                  </ul>
                  <ul>
                     <li class="left_table"><%ejGetML(MLG_WLAN_BasicWirelessSetup_rifs)%> :</li>
                     <li class="right_table">
                        <select name="wlRifsAdvert" size="1">
                           <option value="0"><%ejGetML(MLG_Common_Off)%></option>
                           <option value="-1"><%ejGetML(MLG_Common_Auto)%></option>
                        </select>
                     </li>
                  </ul>
			<!--   remove from GUI page, since we should not allow this function to end user
                  <ul>                     
                     <li class="left_table">Auto Channel Select(ACS) policy :</li>
                     <li class="right_table">					 
		             <select name='acs_policy' size="1" >
			         <option value="0">Default</option>
			         <option value="1">Legacy</option>					 
					 <option value="2">Channel Interference</option>					 
					 <option value="3">Channel Interference + Busy</option>
					 <option value="4">Optimized</option>
					 
			         </select>
					 </li>
                  </ul>
  -->
                  <ul>                     
                     <li class="left_table"><%ejGetML(MLG_WLAN_Other_WPSV2)%> :</li>
                     <li class="right_table">		
					   <tr>
							<td><input type="checkbox" name="wlwscver2" id="wlwscver2" onClick="WPS2Check(0);" /></td>							
					  </tr>
					  <tr> <td>&nbsp;</td> <td>&nbsp;</td> </tr>
					 </li>
                  </ul>
                  <ul>
                     <li class="left_table"><%ejGetML(MLG_WLAN_Other_power_save)%> :</li>
                     <li class="right_table">
                        <select name="wlRxChainPwrSaveEnable" size="1">
                           <option value="0"><%ejGetML(MLG_Common_Disabled)%></option>
                           <option value="1"><%ejGetML(MLG_Common_Enable)%></option>
                        </select>
                     </li>
                  </ul>
                  <ul>
                     <li class="left_table"><%ejGetML(MLG_WLAN_Other_FrameBurst)%> :</li>
                     <li class="right_table">
                        <select name="wlFrameBurst" size="1">
                           <option value="off"><%ejGetML(MLG_Common_Disabled)%></option>
                           <option value="on"><%ejGetML(MLG_Common_Enable)%></option>
                        </select>
                     </li>
                  </ul>
		 <ul>
                     <li class="left_table"><%ejGetML(MLG_WLAN_BasicWirelessSetup_5g_str7)%>:</li>
                     <li class="right_table">
                        <select name="wlObssCoex" size="1">
                           <option value="0"><%ejGetML(MLG_Common_Disabled)%></option>
                           <option value="1"><%ejGetML(MLG_Common_Enable)%></option>
                        </select>
                     </li>
                  </ul>
		<div id="div_regMode">
		  <ul>
                     <li class="left_table"><%ejGetML(MLG_WLAN_BasicWirelessSetup_5g_str3)%>:</li>
                     <li class="right_table">
                        <select name="wlRegMode" size="1" onChange='RegModeChange(false)'>
                           <option value="0"><%ejGetML(MLG_Common_Disabled)%></option>
                           <option value="1"><%ejGetML(MLG_WLAN_BasicWirelessSetup_5g_str1)%></option>
                           <option value="2"><%ejGetML(MLG_WLAN_BasicWirelessSetup_5g_str2)%></option>
                        </select>
                     </li>
                  </ul>
		<ul>
                     <li class="left_table"><%ejGetML(MLG_WLAN_BasicWirelessSetup_5g_str4)%>:</li>
                     <li class="right_table">
                        <input type='text' name='wlDfsPreIsm' size="2">&nbsp;</li>
                  </ul>
				  <ul>
                     <li class="left_table"><%ejGetML(MLG_WLAN_BasicWirelessSetup_5g_str5)%>:</li>
                     <li class="right_table">
                        <input type='text' name='wlDfsPostIsm' size="2">&nbsp;</li>
                  </ul>
		<ul>
                     <li class="left_table"><%ejGetML(MLG_WLAN_BasicWirelessSetup_5g_str6)%>:</li>
                     <li class="right_table">
                        <select name="wlTpcDb" size="1">
                           <option value="0">0 (off)</option>
                           <option value="2">2</option>
			   <option value="3">3</option>
                           <option value="4">4</option>
                        </select>
                     </li>
                  </ul>
	    </div>
    </div>
            </li>
            <input size="15" type="hidden" name="sessionKey" />
            <input size="15" type="hidden" name="wlProtection" />
            <input size="15" type="hidden" name="wlPreambleType" />
            <input size="15" type="hidden" name="wlNmode" />
            <input size="15" type="hidden" name="wlNReqd" />
            <input size="15" type="hidden" name="wlNProtection" />
            <input size="15" type="hidden" name="wlgMode" />
            <input size="15" type="hidden" name="wlBasicRate" />
            <input size="15" type="hidden" name="wlWme" />
            <input size="15" type="hidden" name="wlNBwCap" />
			<input size="15" type="hidden" name="wlWscVer2" />
			
            <li class="space"></li>
            <li class="buttonframe">
               <div class="button_position">
                  <input name="sysSubmit" value="<%ejGetML(MLG_Common_Apply)%>" type="button" onClick="doSubmit0();" />
                     &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
                  <input name="Cancel" value="<%ejGetML(MLG_Common_Cancel)%>" type="button" onClick='frmLoad();' />
</div>
</li>
         </ul></div>
   </form>
   <form action="/pages/tabFW/wireless-others.wl" method="post" onSubmit="return btnApply();">
   <input size="15" type="hidden" name="deviceIndex" />

<div class="data_frame"><ul>
<!--level 1 title start-->
            <li class="title">5G <%ejGetML(MLG_WLAN_Advanced_Str2)%></li>
<!--level 1 title end-->
<li class="set1">
    <div class="w_text" id="24G_other">
                  <ul>
                     <li class="left_table"><%ejGetML(MLG_WLAN_Advanced_Str3)%> :</li>
                     <li class="right_table">
                        <input type='text' name='wlRtsThrshld' maxlength="5" size="5">
                     </li>
                  </ul>
                  <ul>
                     <li class="left_table"><%ejGetML(MLG_WLAN_Advanced_Str4)%> :</li>
                     <li class="right_table">
                        <input type='text' name='wlFrgThrshld' maxlength="5" size="5">
                     </li>
                  </ul>
                  <ul>
                     <li class="left_table"><%ejGetML(MLG_WLAN_Advanced_Str5)%> :</li>
                     <li class="right_table">
                        <input type='text' name='wlCsScanTimer' maxlength="5" size="5"> <%ejGetML(MLG_WLAN_Advanced_Str6)%> </li>
                  </ul>
                  <ul>
                     <li class="left_table"><%ejGetML(MLG_WLAN_Advanced_Str8)%> :</li>
                     <li class="right_table">
                        <select name="wlTxPwrPcnt" size="1">
                           <option value="20">20%</option>
                           <option value="40">40%</option>
                           <option value="60">60%</option>
                           <option value="80">80%</option>
                           <option value="100">100%</option>
                        </select>
                     </li>
                  </ul>
                  <ul>
                     <li class="left_table"><%ejGetML(MLG_WLAN_Advanced_Str9)%> :</li>
                     <li class="right_table">
                        <input type='text' name='wlBcnIntvl' maxlength="5" size="5">&nbsp;<%ejGetML(MLG_WLAN_Advanced_Str7)%> </li>
                  </ul>
                  <ul>
                     <li class="left_table"><%ejGetML(MLG_WLAN_Advanced_Str10)%> :</li>
                     <li class="right_table">
                        <input type='text' name='wlDtmIntvl' maxlength="5" size="5">&nbsp;<%ejGetML(MLG_WLAN_Advanced_Str7)%></li>
                  </ul>
                  <ul id="wlmodeTable2">
                     <li class="left_table"><%ejGetML(MLG_WLAN_BasicWirelessSetup_Str18)%> :</li>
                     <li class="right_table">
                        <select name="wlMode" size='1'onChange="wlModeChange(false);">
                          <script language="javascript">
                          <!-- hide
                             if ( phy5 == 'n') {
                                document.forms[1].wlMode[0] = new Option("<%ejGetML(MLG_Common_80211b)%>", "0");
                                document.forms[1].wlMode[1] = new Option("<%ejGetML(MLG_Common_80211g)%>", "1");
                                document.forms[1].wlMode[2] = new Option("<%ejGetML(MLG_Common_80211n)%>", "2");
                                document.forms[1].wlMode[3] = new Option("<%ejGetML(MLG_Common_80211bg)%>", "3");
                                document.forms[1].wlMode[4] = new Option("<%ejGetML(MLG_Common_80211bgn)%>", "4");
                             }else if( phy5 == 'v' ){
                                document.forms[1].wlMode[0] = new Option("<%ejGetML(MLG_Common_80211a)%>", "0");
                                document.forms[1].wlMode[1] = new Option("<%ejGetML(MLG_Common_80211an)%>", "1");
                                document.forms[1].wlMode[2] = new Option("<%ejGetML(MLG_Common_80211n)%>", "2");
                                document.forms[1].wlMode[3] = new Option("<%ejGetML(MLG_Common_80211anac)%>", "3");
                                document.forms[1].wlMode[4] = new Option("<%ejGetML(MLG_Common_80211nac)%>", "4");
                             }
                             else {
                                document.forms[1].wlMode[0] = new Option("<%ejGetML(MLG_Common_80211b)%>", "0");
                                document.forms[1].wlMode[1] = new Option("<%ejGetML(MLG_Common_80211g)%>", "4");
                                document.forms[1].wlMode[2] = new Option("<%ejGetML(MLG_Common_80211bg)%>", "1");
                             }
                          // done hiding -->
                          </script>
                        </select>
                     </li>
                  </ul>
                  <ul>
                     <li class="left_table"><%ejGetML(MLG_WLAN_BasicWirelessSetup_Str19)%> :</li>
                     <li class="right_table">
                        <select name="wlProtect" size="1">
                           <option value="off"><%ejGetML(MLG_Common_Off)%></option>
                           <option value="auto"><%ejGetML(MLG_Common_Auto)%></option>
                        </select>
                     </li>
                  </ul>
                  <ul>
                     <li class="left_table"><%ejGetML(MLG_WLAN_BasicWirelessSetup_Str20)%> :</li>
                     <li class="right_table">
                        <select name="wlPreamble" size="1">
                           <option value="long"><%ejGetML(MLG_Common_Long)%></option>
                           <option value="short"><%ejGetML(MLG_Common_Short)%></option>
                        </select>
                     </li>
                  </ul>
                  <ul>
                     <li class="left_table"><%ejGetML(MLG_WLAN_BasicWirelessSetup_rifs)%> :</li>
                     <li class="right_table">
                        <select name="wlRifsAdvert" size="1">
                           <option value="0"><%ejGetML(MLG_Common_Off)%></option>
                           <option value="-1"><%ejGetML(MLG_Common_Auto)%></option>
                        </select>
                     </li>
                  </ul>
			<!--   remove from GUI page, since we should not allow this function to end user
                  <ul>                     
                     <li class="left_table">Auto Channel Select(ACS) policy :</li>
                     <li class="right_table">					 
		             <select name='acs_policy' size="1" >
			         <option value="0">Default</option>
			         <option value="1">Legacy</option>					 
					 <option value="2">Channel Interference</option>					 
					 <option value="3">Channel Interference + Busy</option>
					 <option value="4">Optimized</option>
					 
			         </select>
					 </li>
                  </ul>
  -->
                  <ul>                     
                     <li class="left_table"><%ejGetML(MLG_WLAN_Other_WPSV2)%> :</li>
                     <li class="right_table">		
					   <tr>
							<td><input type="checkbox" name="wlwscver2" id="wlwscver2" onClick="WPS2Check(0);" /></td>							
					  </tr>
					  <tr> <td>&nbsp;</td> <td>&nbsp;</td> </tr>
					 </li>
                  </ul>
                  <ul>
                     <li class="left_table"><%ejGetML(MLG_WLAN_Other_power_save)%> :</li>
                     <li class="right_table">
                        <select name="wlRxChainPwrSaveEnable" size="1">
                           <option value="0"><%ejGetML(MLG_Common_Disabled)%></option>
                           <option value="1"><%ejGetML(MLG_Common_Enable)%></option>
                        </select>
                     </li>
                  </ul>
                  <ul>
                     <li class="left_table"><%ejGetML(MLG_WLAN_Other_FrameBurst)%> :</li>
                     <li class="right_table">
                        <select name="wlFrameBurst" size="1">
                           <option value="off"><%ejGetML(MLG_Common_Disabled)%></option>
                           <option value="on"><%ejGetML(MLG_Common_Enable)%></option>
                        </select>
                     </li>
                  </ul>
		 <ul>
                     <li class="left_table"><%ejGetML(MLG_WLAN_BasicWirelessSetup_5g_str7)%>:</li>
                     <li class="right_table">
                        <select name="wlObssCoex" size="1">
                           <option value="0"><%ejGetML(MLG_Common_Disabled)%></option>
                           <option value="1"><%ejGetML(MLG_Common_Enable)%></option>
                        </select>
                     </li>
                  </ul>
		<div id="div_regMode5">
		  <ul>
                     <li class="left_table"><%ejGetML(MLG_WLAN_BasicWirelessSetup_5g_str3)%>:</li>
                     <li class="right_table">
                        <select name="wlRegMode" size="1" onChange='RegModeChange(false)'>
                           <option value="0"><%ejGetML(MLG_Common_Disabled)%></option>
                           <option value="1"><%ejGetML(MLG_WLAN_BasicWirelessSetup_5g_str1)%></option>
                           <option value="2"><%ejGetML(MLG_WLAN_BasicWirelessSetup_5g_str2)%></option>
                        </select>
                     </li>
                  </ul>
		<ul>
                     <li class="left_table"><%ejGetML(MLG_WLAN_BasicWirelessSetup_5g_str4)%>:</li>
                     <li class="right_table">
                        <input type='text' name='wlDfsPreIsm' size="2">&nbsp;</li>
                  </ul>
				  <ul>
                     <li class="left_table"><%ejGetML(MLG_WLAN_BasicWirelessSetup_5g_str5)%>:</li>
                     <li class="right_table">
                        <input type='text' name='wlDfsPostIsm' size="2">&nbsp;</li>
                  </ul>
		<ul>
                     <li class="left_table"><%ejGetML(MLG_WLAN_BasicWirelessSetup_5g_str6)%>:</li>
                     <li class="right_table">
                        <select name="wlTpcDb" size="1">
                           <option value="0">0 (off)</option>
                           <option value="2">2</option>
			   <option value="3">3</option>
                           <option value="4">4</option>
                        </select>
                     </li>
                  </ul>
	    </div>
    </div>
            </li>
            <input size="15" type="hidden" name="sessionKey" />
            <input size="15" type="hidden" name="wlProtection" />
            <input size="15" type="hidden" name="wlPreambleType" />
            <input size="15" type="hidden" name="wlNmode" />
            <input size="15" type="hidden" name="wlNReqd" />
            <input size="15" type="hidden" name="wlNProtection" />
            <input size="15" type="hidden" name="wlgMode" />
            <input size="15" type="hidden" name="wlBasicRate" />
            <input size="15" type="hidden" name="wlWme" />
            <input size="15" type="hidden" name="wlNBwCap" />
			<input size="15" type="hidden" name="wlWscVer2" />
			
            <li class="space"></li>
            <li class="buttonframe">
               <div class="button_position">
                  <input name="sysSubmit" value="<%ejGetML(MLG_Common_Apply)%>" type="button" onClick="doSubmit1();" />
                     &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
                  <input name="Cancel" value="<%ejGetML(MLG_Common_Cancel)%>" type="button" onClick='frmLoad();' />
</div>
</li>
         </ul></div>
   </form>   
</div>
   
<script language="javascript">
<!-- hide
   frmLoad();
// done hiding -->
</script>