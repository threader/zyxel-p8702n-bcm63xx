<script language="javascript">
<!-- hide

var vd_lan1;
var vd_lan2;
var vd_lan3;
var vd_lan4;
var vd_lan5;
var vd_dslLine1;
var vd_ethWAN;
var wanLevel;
var wanToLanEnbl;
var vd_usb1;
//var vd_usb2;
//var vd_voip;
var Ary = new Array();
var vd_voip1;
var vd_voip2;
var wifi;
var wlEnbl = '<%ejGetWl(wlEnbl_wl0v0)%>' | '<%ejGetWl(wlEnbl_wl0v1)%>' | '<%ejGetWl(wlEnbl_wl0v2)%>' | '<%ejGetWl(wlEnbl_wl0v3)%>';
var wlSenbl = '<%ejGetWl(SwlEnbl_wl0v0)%>' | '<%ejGetWl(SwlEnbl_wl0v1)%>' | '<%ejGetWl(SwlEnbl_wl0v2)%>' | '<%ejGetWl(SwlEnbl_wl0v3)%>';
var vd_voip = '<%ejGetVoice(sipStatus)%>';         // SIP Status
var tmpphoneselect = '<%ejGetVoice(phoneSelect)%>';
var currentAcnt = '<%ejGetVoice(numLines)%>';

wanToLanEnbl = <%ejGetOther(sysInfo, enblEthWanToLan)%>;
vd_lan1 = '<%ejGetOther(ifStatus,LAN,eth0,status2)%>';
vd_lan2 = '<%ejGetOther(ifStatus,LAN,eth1,status2)%>';
vd_lan3 = '<%ejGetOther(ifStatus,LAN,eth2,status2)%>';
vd_lan4 = '<%ejGetOther(ifStatus,LAN,eth3,status2)%>';
vd_lan5 = '<%ejGetOther(ifStatus,LAN,eth4,status2)%>';
vd_dslLine1 = '<%ejGetOther(ifStatus,WAN,DSL,0)%>';
vd_ethWAN = '<%ejGetOther(ifStatus,WAN,eth4,status2)%>';
wanLevel = '<%ejGetOther(sysInfo, wanStatus)%>';
wifi = wlEnbl | wlSenbl;

vd_usb1='<%ejGetOther(ifStatus,USB,usbNum1,status1)%>';
//vd_usb2='<%ejGetOther(ifStatus,USB,usbNum2,status1)%>';

//vd_voip = '<%ejGetVoice(voipPhoneStatus)%>';
Ary = vd_voip.split("&");
vd_voip1 = Ary[0];
vd_voip2 = Ary[1];

function initVirtualDevice()
{
   var vd_lan1_msg = '';
   var vd_lan2_msg = '';
   var vd_lan3_msg = '';
   var vd_lan4_msg = '';
   var vd_dslLine1_msg = '';
   var vd_ethWAN_msg = '';
   var vd_usb1_msg = '';
   //var vd_usb2_msg = '';
   var vd_wifi_msg = '';
   var vd_voip1_msg = '';
   var vd_voip2_msg = '';
   var tmpvoip = vd_voip.split(';');
   var tmpphone = tmpphoneselect.split(';');
   var tmpcurrAcnt = parseInt(currentAcnt);
   var j =0;
   var i =1;
   var tmp = 0;
   var phone1 = 0;
   var phone2 = 0;
   

   vd_voip1 = 'off';
   vd_voip2 = 'off';

   
for(i=1;i<=tmpcurrAcnt;i++){	
    
	if((tmpvoip[j].search("On Register"))>=0){
     
     tmp=parseInt(tmpphone[i-1].charAt(10));
	 
	 switch (tmp){
	  case 1:
	  	phone1 = 0;
		phone2 = 1;
		break;
	  case 2:
	  	phone1 = 1;
		phone2 = 0;
		break;
	  case 3:
	  	phone1 = 1;
		phone2 = 1;
		break;
	  default:
	  	phone1 = 0;
		phone2 = 0;
		break;
	 }
}
	j=j+6;
	if(phone1==1)
		vd_voip1='on';
	if(phone2==1)
   vd_voip2 = 'on';
}


   // init msg
   if(vd_lan1 == 'on'){
      vd_lan1_msg = MLG_Makestring("<%ejGetML(MLG_ConnStatus_VD_Str1)%>",1);
   }
   if(vd_lan2 == 'on'){
      vd_lan2_msg = MLG_Makestring("<%ejGetML(MLG_ConnStatus_VD_Str1)%>",2);
   }
   if(vd_lan3 == 'on'){
      vd_lan3_msg = MLG_Makestring("<%ejGetML(MLG_ConnStatus_VD_Str1)%>",3);
   }
   if(vd_lan4 == 'on'){
      vd_lan4_msg = MLG_Makestring("<%ejGetML(MLG_ConnStatus_VD_Str1)%>",4);
   }
   if(vd_dslLine1 == 'on'){
      vd_dslLine1_msg = '<%ejGetML(MLG_ConnStatus_VD_Str3)%>';
   }
   if(wanToLanEnbl == '1') {
      if(vd_lan5 == 'on'){
         vd_ethWAN_msg = '<%ejGetML(MLG_ConnStatus_Status_Str30)%> <%ejGetML(MLG_Common_On)%>';
      }
      vd_ethWAN = vd_lan5;
   } else {
      if(vd_ethWAN == 'on'){
         vd_ethWAN_msg = '<%ejGetML(MLG_ConnStatus_VD_Str4)%>';
      }
   }
   
   if(vd_usb1 == 'on'){
      vd_usb1_msg = MLG_Makestring("<%ejGetML(MLG_ConnStatus_VD_Str7)%>",1);
   }
   /*
   if(vd_usb2 == 'on'){
      vd_usb2_msg = MLG_Makestring("<%ejGetML(MLG_ConnStatus_VD_Str7)%>",2);
   }*/
   if(wifi == '1'){
   	  wifi = 'on';
      vd_wifi_msg = '<%ejGetML(MLG_ConnStatus_VD_Str2)%>';
   }else{
      wifi = 'off';
   }
   if(vd_voip1 == 'on'){
      vd_voip1_msg = MLG_Makestring("<%ejGetML(MLG_ConnStatus_VD_Str6)%>",1);	  
   }
   else{
	  vd_voip1 ='off';
   }

   if(vd_voip2 == 'on'){
      vd_voip2_msg = MLG_Makestring("<%ejGetML(MLG_ConnStatus_VD_Str6)%>",2);	  
   }
   else{
      vd_voip2 ='off';
   }

   var VDdate = {
      dslline: {status: vd_dslLine1, msg: vd_dslLine1_msg },
      lan1: {status: vd_lan1, msg: vd_lan1_msg},
      lan2: {status: vd_lan2, msg: vd_lan2_msg},
      lan3: {status: vd_lan3, msg: vd_lan3_msg},
      lan4: {status: vd_lan4, msg: vd_lan4_msg},
      wan: {status: vd_ethWAN, msg: vd_ethWAN_msg},
      usb1: {status: vd_usb1, msg: vd_usb1_msg},
      wifiSignal: {status: wifi, msg: vd_wifi_msg},
      //usb2: {status: vd_usb2, msg: vd_usb2_msg},
      voip1: {status: vd_voip1, msg: vd_voip1_msg},
      voip2: {status: vd_voip2, msg: vd_voip2_msg}
   };
   
   var $VDObj = $('#vdContainer').VDcomponent({
      vdHtml: '/pages/VD/vd/VD.html',
      vdCss: ['/pages/VD/vd/css/css.css'],
      portDef:'/pages/VD/vd/portDef.js'
   });

   if(wanToLanEnbl == '1') {
      $('#wanLable').html('LAN 5');
   }

   $VDObj.setValue(VDdate);
}

function updateValue(msg){   
   var upDate = msg.replace(/\r\n/ig, "");
   upDate = upDate.replace(/\n/ig, "");
   var upDates = upDate.split("@@");
   wanToLanEnbl = upDates[0];
   vd_lan1 = (((upDates[1] == undefined) || (upDates[1] == '')) ? 'off' : upDates[1]);
   vd_lan2 = (((upDates[2] == undefined) || (upDates[2] == '')) ? 'off' : upDates[2]);
   vd_lan3 = (((upDates[3] == undefined) || (upDates[3] == '')) ? 'off' : upDates[3]);
   vd_lan4 = (((upDates[4] == undefined) || (upDates[4] == '')) ? 'off' : upDates[4]);
   vd_lan5 = (((upDates[5] == undefined) || (upDates[5] == '')) ? 'off' : upDates[5]);
   vd_dslLine1 = (((upDates[6] == undefined) || (upDates[6] == '')) ? 'off' : upDates[6]);
   vd_ethWAN = (((upDates[7] == undefined) || (upDates[7] == '')) ? 'off' : upDates[7]);
   wanLevel = upDates[8];
   vd_usb1 = (((upDates[9] == undefined) || (upDates[9] == '')) ? 'off' : upDates[9]);
   wifi =(((upDates[10] == undefined) || (upDates[10] == '')) ? 'off' : upDates[10]);
   //vd_usb2 = (((upDates[10] == undefined) || (upDates[10] == '')) ? 'off' : upDates[10]);
   vd_voip1 = (((upDates[11] == undefined) || (upDates[11] == '')) ? 'off' : upDates[11].split("&")[0]);
   vd_voip2 = (((upDates[11] == undefined) || (upDates[11] == '')) ? 'off' : upDates[11].split("&")[1]);
   //vd_voip = upDates[11];   
   tmpphoneselect = upDates[12];
   currentAcnt = upDates[13];
   
   frmLoad();
}

function frmLoad() {
   // init Virtual Device
   initVirtualDevice();

   if(wanLevel == '0') {
      connection(true, wanLevel);
   } else {
      connection(false, wanLevel);
   }
}

$(document).ready(function() {
	frmLoad();
});

// done hiding -->
</script>

<div id='VDView' class='naviView' style='position: relative;'>
  <div id='vdContainer' style='position:relative; left:4%;right:4%; top:100px; '></div> 
</div>