#!/usr/bin/perl
use strict;
use warnings;
use FindBin qw($Bin);
use lib "$Bin/../../PerlLib";
use BRCM::GenConfig;

# $p will allow us to GET values from the PROFILE
# $c will allow us to SET (and GET and DRIVER_SETUP) on the config
# file as we transform it from a template to the final config

# arguments
# * profile file
# * config  file
my $p    = new BRCM::GenConfig(shift);
my $chip = $p->get('BRCM_CHIP');
my $arch = $p->get('PROFILE_ARCH');

my $c    = new BRCM::GenConfig( shift, Chip => $chip, Profile => $p );

############################################################
#          KERNEL FEATURES CONFIGURATION                   #
############################################################

if ( $p->get('BCM_KERNEL_CMDLINE_BOOL') ) {
    $c->set( 'CONFIG_CMDLINE_BOOL', 'y' );
    $c->set( 'CONFIG_CMDLINE', $p->get('BCM_KERNEL_CMDLINE') );
    $c->set( 'CONFIG_CMDLINE_OVERRIDE', $p->get('BCM_KERNEL_CMDLINE_OVERRIDE') );
}

# If we are including debug tools in this build, then make
# the kernel .config file available via /proc/config.gz
# and also enable DEBUG_FS
if ( $p->get('BUILD_DEBUG_TOOLS') ) {
    $c->set( 'CONFIG_IKCONFIG',                        'y' );
    $c->set( 'CONFIG_IKCONFIG_PROC',                   'y' );
    $c->set( 'CONFIG_DEBUG_FS',                        'y' );
}

$c->set('CONFIG_BRCM_IKOS', $p->get('BRCM_IKOS'));

if ( $chip eq '68500' ) {
    $c->set( 'CONFIG_BCM_CPU_ARCH_NAME',    '"mips32r2"' );
    $c->set( 'CONFIG_CRYPTO_ECB',                      'y' );
    $c->set( 'CONFIG_LOG_BUF_SHIFT',                   '16' );
    $c->set( 'CONFIG_MIPS_L1_CACHE_SHIFT',             '5' );
    $c->set( 'CONFIG_CRYPTO_PCBC',                     'y' );
    $c->set( 'CONFIG_FRAME_WARN',                      '7000' );
    $c->set( 'CONFIG_NETFILTER_XT_MARK',               'm' );
    $c->set( 'CONFIG_IP_NF_MANGLE',                    'y' );
    $c->set( 'CONFIG_NET_VENDOR_MICROCHIP',            'y' );
    $c->set( 'CONFIG_NET_ACT_IPT',                     'y' );
    $c->set( 'CONFIG_TEXTSEARCH_BM',                   'y' );
    $c->set( 'CONFIG_CRYPTO_ECB',                      'y' );
    $c->set( 'CONFIG_BITREVERSE',                      'y' );
    $c->set( 'CONFIG_MTD_BLOCK2MTD',                   'y' );
    $c->set( 'CONFIG_NF_DEFRAG_IPV6',                  'y' );
    $c->set( 'CONFIG_SERIAL_CORE',                     'y' );
    $c->set( 'CONFIG_HZ_100',                          'y' );
    $c->set( 'CONFIG_UFS_FS',                          'y' );
    $c->set( 'CONFIG_ARCH_SUPPORTS_MSI',               'y' );
    $c->set( 'CONFIG_NETFILTER_XT_MATCH_LIMIT',        'y' );
    $c->set( 'CONFIG_NFSD_V3',                         'y' );
    $c->set( 'CONFIG_BRIDGE_IGMP_SNOOPING',            'y' );
    $c->set( 'CONFIG_GENERIC_CLOCKEVENTS_BUILD',       'y' );
    $c->set( 'CONFIG_NF_CONNTRACK_TFTP',               'y' );
    $c->set( 'CONFIG_PREEMPT_NONE',                    'y' );
    $c->set( 'CONFIG_MTD_M25P80',                      'y' );
    $c->set( 'CONFIG_HAVE_DYNAMIC_FTRACE',             'y' );
    $c->set( 'CONFIG_NETWORK_FILESYSTEMS',             'y' );
    $c->set( 'CONFIG_PM_SLEEP',                        'y' );
    $c->set( 'CONFIG_CRYPTO_PCOMP',                    'y' );
    $c->set( 'CONFIG_NET_CLS_FLOW',                    'y' );
    $c->set( 'CONFIG_RT_MUTEXES',                      'y' );
    $c->set( 'CONFIG_NLATTR',                          'y' );
    $c->set( 'CONFIG_NLS_DEFAULT',                     '"iso8859-1"' );
    $c->set( 'CONFIG_ELF_CORE',                        'y' );
    $c->set( 'CONFIG_NET_EMATCH_TEXT',                 'y' );
    $c->set( 'CONFIG_IPV6_SIT',                        'y' );
    $c->set( 'CONFIG_HAVE_OPROFILE',                   'y' );
    $c->set( 'CONFIG_NF_CONNTRACK_MARK',               'y' );
    $c->set( 'CONFIG_NETFILTER_XT_CONNMARK',           'y' );
    $c->set( 'CONFIG_NET_SCH_TBF',                     'y' );
    $c->set( 'CONFIG_NET_EMATCH',                      'y' );
    $c->set( 'CONFIG_DEBUG_DRIVER',                    'y' );
    $c->set( 'CONFIG_NLS_CODEPAGE_437',                'y' );
    $c->set( 'CONFIG_NFS_V3',                          'y' );
    $c->set( 'CONFIG_FUTEX',                           'y' );
    $c->set( 'CONFIG_ZLIB_INFLATE',                    'y' );
    $c->set( 'CONFIG_DQL',                             'y' );
    $c->set( 'CONFIG_STP',                             'y' );
    $c->set( 'CONFIG_ARCH_HIBERNATION_POSSIBLE',       'y' );
    $c->set( 'CONFIG_CRYPTO_BLKCIPHER',                'y' );
    $c->set( 'CONFIG_SQUASHFS_EMBEDDED',               'y' );
    $c->set( 'CONFIG_COMPAT_BRK',                      'y' );
    $c->set( 'CONFIG_SYS_SUPPORTS_HIGHMEM',            'y' );
    $c->set( 'CONFIG_BCM968500',                  'y' );
    $c->set( 'CONFIG_ARCH_DISCARD_MEMBLOCK',           'y' );
    $c->set( 'CONFIG_NFS_FS',                          'y' );
    $c->set( 'CONFIG_SERIAL_CORE_CONSOLE',             'y' );
    $c->set( 'CONFIG_NET_SCH_SFQ',                     'y' );
    $c->set( 'CONFIG_NF_CONNTRACK_IPV4',               'y' );
    $c->set( 'CONFIG_NETFILTER_XT_TARGET_CLASSIFY',    'y' );
    $c->set( 'CONFIG_INLINE_WRITE_UNLOCK',             'y' );
    $c->set( 'CONFIG_CRYPTO_AEAD2',                    'y' );
    $c->set( 'CONFIG_ANON_INODES',                     'y' );
    $c->set( 'CONFIG_NF_DEFRAG_IPV4',                  'y' );
    $c->set( 'CONFIG_CPU_MIPS32',                      'y' );
    $c->set( 'CONFIG_WLAN',                            'y' );
    $c->set( 'CONFIG_HAVE_PERF_EVENTS',                'y' );
    $c->set( 'CONFIG_MODULE_FORCE_LOAD',               'y' );
    $c->set( 'CONFIG_SYS_SUPPORTS_100HZ',              'y' );
    $c->set( 'CONFIG_CRYPTO_LZO',                      'y' );
    $c->set( 'CONFIG_IP_ADVANCED_ROUTER',              'y' );
    $c->set( 'CONFIG_IPV6_NDISC_NODETYPE',             'y' );
    $c->set( 'CONFIG_HAVE_FUNCTION_TRACER',            'y' );
    $c->set( 'CONFIG_HAVE_FTRACE_MCOUNT_RECORD',       'y' );
    $c->set( 'CONFIG_NET_VENDOR_CHELSIO',              'y' );
    $c->set( 'CONFIG_VIRT_TO_BUS',                     'y' );
    $c->set( 'CONFIG_HAVE_GENERIC_DMA_COHERENT',       'y' );
    $c->set( 'CONFIG_CRYPTO_MANAGER2',                 'y' );
    $c->set( 'CONFIG_ETHERNET',                        'y' );
    $c->set( 'CONFIG_TEXTSEARCH_KMP',                  'y' );
    $c->set( 'CONFIG_SCSI_WAIT_SCAN',                  'm' );
    $c->set( 'CONFIG_HIGHMEM',                         'y' );
    $c->set( 'CONFIG_TINY_RCU',                        'y' );
    $c->set( 'CONFIG_CRYPTO_BLKCIPHER2',               'y' );
    $c->set( 'CONFIG_NET_EMATCH_META',                 'y' );
    $c->set( 'CONFIG_LZO_DECOMPRESS',                  'y' );
    $c->set( 'CONFIG_JFFS2_RUBIN',                     'y' );
    $c->set( 'CONFIG_SPI_BITBANG',                     'y' );
    $c->set( 'CONFIG_NF_CONNTRACK_IPV6',               'y' );
    $c->set( 'CONFIG_IP_NF_TARGET_REJECT',             'y' );
    $c->set( 'CONFIG_PERF_USE_VMALLOC',                'y' );
    $c->set( 'CONFIG_SLABINFO',                        'y' );
    $c->set( 'CONFIG_TEXTSEARCH',                      'y' );
    $c->set( 'CONFIG_NET_VENDOR_MICREL',               'y' );
    $c->set( 'CONFIG_NET_VENDOR_SMSC',                 'y' );
    $c->set( 'CONFIG_MSDOS_PARTITION',                 'y' );
    $c->set( 'CONFIG_NFSD',                            'y' );
    $c->set( 'CONFIG_FAT_DEFAULT_IOCHARSET',           '"iso8859-1"' );
    $c->set( 'CONFIG_ROOT_NFS',                        'y' );
    $c->set( 'CONFIG_SCSI',                            'y' );
    $c->set( 'CONFIG_IPV6',                            'y' );
    $c->set( 'CONFIG_RUNTIME_DEBUG',                   'y' );
    $c->set( 'CONFIG_BRIDGE_NF_EBTABLES',              'y' );
    $c->set( 'CONFIG_NET_SCH_FIFO',                    'y' );
    $c->set( 'CONFIG_EPOLL',                           'y' );
    $c->set( 'CONFIG_HAVE_MEMBLOCK_NODE_MAP',          'y' );
    $c->set( 'CONFIG_INET_TUNNEL',                     'y' );
    $c->set( 'CONFIG_CRYPTO_ALGAPI',                   'y' );
    $c->set( 'CONFIG_IP6_NF_IPTABLES',                 'y' );
    $c->set( 'CONFIG_CRYPTO_WORKQUEUE',                'y' );
    $c->set( 'CONFIG_SQUASHFS',                        'y' );
    $c->set( 'CONFIG_SQUASHFS_ZLIB',                   'y' );
    $c->set( 'CONFIG_SQUASHFS_FRAGMENT_CACHE_SIZE',    '3' );
    $c->set( 'CONFIG_MIPS_L1_CACHE_SHIFT',             '5' );
    $c->set( 'CONFIG_BCM_MAX_GEM_PORTS',               '32' );
    $c->set( 'CONFIG_CRC32',                           'y' );
    $c->set( 'CONFIG_PAGEFLAGS_EXTENDED',              'y' );
    $c->set( 'CONFIG_NET_VENDOR_BROADCOM',             'y' );
    $c->set( 'CONFIG_IP_NF_FILTER',                    'y' );
    $c->set( 'CONFIG_MTD_CHAR',                        'y' );
    $c->set( 'CONFIG_IP_ROUTE_CLASSID',                'y' );
    $c->set( 'CONFIG_LZO_COMPRESS',                    'y' );
    $c->set( 'CONFIG_GENERIC_CLOCKEVENTS',             'y' );
    $c->set( 'CONFIG_TRACING_SUPPORT',                 'y' );
    $c->set( 'CONFIG_CHR_DEV_SG',                      'y' );
    $c->set( 'CONFIG_CRYPTO_HASH2',                    'y' );
    $c->set( 'CONFIG_DEBUG_DEVRES',                    'y' );
    $c->set( 'CONFIG_AIO',                             'y' );
    $c->set( 'CONFIG_CRC16',                           'y' );
    $c->set( 'CONFIG_CRYPTO_MANAGER',                  'y' );
    $c->set( 'CONFIG_MII',                             'y' );
    $c->set( 'CONFIG_NEED_PER_CPU_KM',                 'y' );
    $c->set( 'CONFIG_HAVE_FUNCTION_TRACE_MCOUNT_TEST', 'y' );
    $c->set( 'CONFIG_HW_HAS_PCI',                      'y' );
    $c->set( 'CONFIG_HARDWARE_WATCHPOINTS',            'y' );
    $c->set( 'CONFIG_NET_CLS_ROUTE4',                  'y' );
    $c->set( 'CONFIG_NET_SCH_NETEM',                   'y' );
    $c->set( 'CONFIG_ARCH_BINFMT_ELF_RANDOMIZE_PIE',   'y' );
    $c->set( 'CONFIG_BCMA_POSSIBLE',                   'y' );
    $c->set( 'CONFIG_CRYPTO_DEFLATE',                  'y' );
    $c->set( 'CONFIG_BOOT_ELF32',                      'y' );
    $c->set( 'CONFIG_PCI',                             'y' );
    $c->set( 'CONFIG_NET_IPIP',                        'y' );
    $c->set( 'CONFIG_FAT_FS',                          'y' );
    $c->set( 'CONFIG_IP_PNP',                          'y' );
    $c->set( 'CONFIG_JFFS2_FS_WRITEBUFFER',            'y' );
    $c->set( 'CONFIG_NET_VENDOR_INTEL',                'y' );
    $c->set( 'CONFIG_NET_SCH_MULTIQ',                  'y' );
    $c->set( 'CONFIG_INET_LRO',                        'y' );
    $c->set( 'CONFIG_HAVE_MEMBLOCK',                   'y' );
    $c->set( 'CONFIG_SERIAL_8250',                     'y' );
    $c->set( 'CONFIG_RTC_LIB',                         'y' );
    $c->set( 'CONFIG_DEBUG_KERNEL',                    'y' );
    $c->set( 'CONFIG_NET_SCH_TEQL',                    'y' );
    $c->set( 'CONFIG_NET_SCH_CBQ',                     'y' );
    $c->set( 'CONFIG_SYS_SUPPORTS_32BIT_KERNEL',       'y' );
    $c->set( 'CONFIG_NF_CT_PROTO_GRE',                 'y' );
    $c->set( 'CONFIG_NEED_DMA_MAP_STATE',              'y' );
    $c->set( 'CONFIG_MTD_NAND',                        'y' );
    $c->set( 'CONFIG_SCSI_MOD',                        'y' );
    $c->set( 'CONFIG_WIRELESS',                        'y' );
    $c->set( 'CONFIG_FAT_DEFAULT_CODEPAGE',            '437' );
    $c->set( 'CONFIG_IOMMU_SUPPORT',                   'y' );
    $c->set( 'CONFIG_NET_SCH_DRR',                     'y' );
    $c->set( 'CONFIG_NET_VENDOR_STMICRO',              'y' );
    $c->set( 'CONFIG_NF_CONNTRACK_FTP',                'y' );
    $c->set( 'CONFIG_FREEZER',                         'y' );
    $c->set( 'CONFIG_SSB_POSSIBLE',                    'y' );
    $c->set( 'CONFIG_NET_SCH_HTB',                     'y' );
    $c->set( 'CONFIG_IP6_NF_FILTER',                   'y' );
    $c->set( 'CONFIG_HAVE_IDE',                        'y' );
    $c->set( 'CONFIG_CRYPTO_RNG2',                     'y' );
    $c->set( 'CONFIG_LOCKD_V4',                        'y' );
    $c->set( 'CONFIG_BOUNCE',                          'y' );
    $c->set( 'CONFIG_ZLIB_DEFLATE',                    'y' );
    $c->set( 'CONFIG_NET_SCH_GRED',                    'y' );
    $c->set( 'CONFIG_NET_VENDOR_NATSEMI',              'y' );
    $c->set( 'CONFIG_NET_CLS',                         'y' );
    $c->set( 'CONFIG_NLS_ASCII',                       'y' );
    $c->set( 'CONFIG_SCHED_OMIT_FRAME_POINTER',        'y' );
    $c->set( 'CONFIG_DEFAULT_SECURITY_DAC',            'y' );
    $c->set( 'CONFIG_HZ',                              '100' );
    $c->set( 'CONFIG_EXPORTFS',                        'y' );
    $c->set( 'CONFIG_CPU_SUPPORTS_32BIT_KERNEL',       'y' );
    $c->set( 'CONFIG_CPU_SUPPORTS_HIGHMEM',            'y' );
    $c->set( 'CONFIG_NET_VENDOR_MARVELL',              'y' );
    $c->set( 'CONFIG_NET_EMATCH_CMP',                  'y' );
    $c->set( 'CONFIG_SUSPEND_FREEZER',                 'y' );
    $c->set( 'CONFIG_CRYPTO_PCBC',                     'y' );
    $c->set( 'CONFIG_NET_CLS_FW',                      'y' );
    $c->set( 'CONFIG_JFFS2_CMODE_PRIORITY',            'y' );
    $c->set( 'CONFIG_SYS_HAS_CPU_MIPS32_R2',           'y' );
    $c->set( 'CONFIG_NET_EMATCH_NBYTE',                'y' );
    $c->set( 'CONFIG_HAVE_C_RECORDMCOUNT',             'y' );
    $c->set( 'CONFIG_NET_SCH_HFSC',                    'y' );
    $c->set( 'CONFIG_SIGNALFD',                        'y' );
    $c->set( 'CONFIG_NF_CONNTRACK',                    'y' );
    $c->set( 'CONFIG_VFAT_FS',                         'y' );
    $c->set( 'CONFIG_LBDAF',                           'y' );
    $c->set( 'CONFIG_SERIAL_8250_CONSOLE',             'y' );
    $c->set( 'CONFIG_JFFS2_COMPRESSION_OPTIONS',       'y' );
    $c->set( 'CONFIG_NET_VENDOR_8390',                 'y' );
    $c->set( 'CONFIG_TEXTSEARCH_FSM',                  'y' );
    $c->set( 'CONFIG_CRYPTO',                          'y' );
    $c->set( 'CONFIG_NLS_ISO8859_1',                   'y' );
    $c->set( 'CONFIG_JFFS2_FS',                        'y' );
    $c->set( 'CONFIG_HAS_DMA',                         'y' );
    $c->set( 'CONFIG_CPU_MIPS32_R2',                   'y' );
    $c->set( 'CONFIG_JFFS2_LZO',                       'y' );
    $c->set( 'CONFIG_NET_SCH_PRIO',                    'y' );
    $c->set( 'CONFIG_DEFAULT_SECURITY',                '""' );
    $c->set( 'CONFIG_POSIX_MQUEUE_SYSCTL',             'y' );
    $c->set( 'CONFIG_NET_CLS_ACT',                     'y' );
    $c->set( 'CONFIG_SERIAL_8250_NR_UARTS',            '1' );
    $c->set( 'CONFIG_GENERIC_CMOS_UPDATE',             'y' );
    $c->set( 'CONFIG_CRYPTO_MD5',                      'y' );
    $c->set( 'CONFIG_INLINE_READ_UNLOCK',              'y' );
    $c->set( 'CONFIG_NET_VENDOR_I825XX',               'y' );
    $c->set( 'CONFIG_TIMERFD',                         'y' );
    $c->set( 'CONFIG_TIMER_STATS',                     'y' );
    $c->set( 'CONFIG_PCI_LEGACY',                      'y' );
    $c->set( 'CONFIG_SYS_SUPPORTS_BIG_ENDIAN',         'y' );
    $c->set( 'CONFIG_MSDOS_FS',                        'y' );
    $c->set( 'CONFIG_SCSI_PROC_FS',                    'y' );
    $c->set( 'CONFIG_GENERIC_HARDIRQS_NO__DO_IRQ',     'y' );
    $c->set( 'CONFIG_M25PXX_USE_FAST_READ',            'y' );
    $c->set( 'CONFIG_HAVE_FUNCTION_GRAPH_TRACER',      'y' );
    $c->set( 'CONFIG_MTD_SST25L',                      'y' );
    $c->set( 'CONFIG_ARCH_SUSPEND_POSSIBLE',           'y' );
    $c->set( 'CONFIG_IP_PNP_DHCP',                     'y' );
    $c->set( 'CONFIG_NET_SCHED',                       'y' );
    $c->set( 'CONFIG_CRYPTO_ALGAPI2',                  'y' );
    $c->set( 'CONFIG_NET_CLS_TCINDEX',                 'y' );
    $c->set( 'CONFIG_NF_CONNTRACK_SIP',                'y' );
    $c->set( 'CONFIG_LOCKD',                           'y' );
    $c->set( 'CONFIG_CRYPTO_ZLIB',                     'y' );
    $c->set( 'CONFIG_CRYPTO_PCOMP2',                   'y' );
    $c->set( 'CONFIG_PCI_DOMAINS',                     'y' );
    $c->set( 'CONFIG_IP6_NF_TARGET_REJECT',            'y' );
    $c->set( 'CONFIG_GENERIC_IO',                      'y' );
    $c->set( 'CONFIG_SERIAL_8250_RUNTIME_UARTS',       '1' );
    $c->set( 'CONFIG_NET_CLS_BASIC',                   'y' );
    $c->set( 'CONFIG_IP_NF_IPTABLES',                  'y' );
    $c->set( 'CONFIG_EVENTFD',                         'y' );
    $c->set( 'CONFIG_NET_SCH_DSMARK',                  'y' );
    $c->set( 'CONFIG_CRYPTO_HASH',                     'y' );
    $c->set( 'CONFIG_NLS',                             'y' );
    $c->set( 'CONFIG_CPU_MIPSR2',                      'y' );
    $c->set( 'CONFIG_MTD_NAND_ECC',                    'y' );
    $c->set( 'CONFIG_NET_SCH_RED',                     'y' );
    $c->set( 'CONFIG_JFFS2_FS_DEBUG',                  '0' );
    $c->set( 'CONFIG_NETFILTER_XT_TARGET_CONNMARK',    'y' );
    $c->set( 'CONFIG_CPU_HAS_PREFETCH',                'y' );
    $c->set( 'CONFIG_DEBUG_INFO',                      'y' );
    $c->set( 'CONFIG_PM',                              'y' );
    $c->set( 'CONFIG_NF_CONNTRACK_PPTP',               'y' );
    $c->set( 'CONFIG_MTD_BLOCK',                       'y' );
    $c->set( 'CONFIG_IRQ_CPU',                         'y' );
    $c->set( 'CONFIG_BQL',                             'y' );
    $c->set( 'CONFIG_NET_VENDOR_SEEQ',                 'y' );
    $c->set( 'CONFIG_SCSI_DMA',                        'y' );
    $c->set( 'CONFIG_HAVE_ARCH_KGDB',                  'y' );
    $c->set( 'CONFIG_EXPERT',                          'y' );
    $c->set( 'CONFIG_NET_EMATCH_U32',                  'y' );
    $c->set( 'CONFIG_NLS_UTF8',                        'y' );
    $c->set( 'CONFIG_POSIX_MQUEUE',                    'y' );
    $c->set( 'CONFIG_NFS_COMMON',                      'y' );
    $c->set( 'CONFIG_GENERIC_ATOMIC64',                'y' );
    $c->set( 'CONFIG_SUNRPC',                          'y' );
    $c->set( 'CONFIG_NET_EMATCH_STACK',                '32' );
    $c->set( 'CONFIG_BCM_WLAN_IMPL_SELECT',                  '""' );
}
elsif ( $chip =~ /^(63138|63148)$/ ) {
    $c->set( 'CONFIG_ARCH_BCM63XX',                    'y' );
    $c->set( 'CONFIG_BOARD_ZRELADDR',                  '0x00008000' );
    $c->set( 'CONFIG_BOARD_PARAMS_PHYS',               '0x00000000' );
    $c->set( 'CONFIG_HZ',                              '100' );
    $c->set( 'CONFIG_BCM_KERNEL_CUSTOM',               'y' );
    $c->set( 'CONFIG_LOG_BUF_SHIFT',                   '14' );
    $c->set( 'CONFIG_HIGH_RES_TIMERS',                 'y' );
    $c->set( 'CONFIG_EXPERT',                          'y' );
    $c->set( 'CONFIG_GENERIC_CLOCKEVENTS_BUILD',       'y' );
    $c->set( 'CONFIG_GENERIC_CLOCKEVENTS',             'y' );
    $c->set( 'CONFIG_GENERIC_CLOCKEVENTS_BROADCAST',   'y' );
    $c->set( 'CONFIG_HAVE_FUNCTION_TRACER',            'y' );
    $c->set( 'CONFIG_HAVE_FUNCTION_GRAPH_TRACER',      'y' );
    $c->set( 'CONFIG_HAVE_DYNAMIC_FTRACE',             'y' );
    $c->set( 'CONFIG_HAVE_FTRACE_MCOUNT_RECORD',       'y' );
    $c->set( 'CONFIG_HAVE_C_RECORDMCOUNT',             'y' );
    $c->set( 'CONFIG_TRACING_SUPPORT',                 'y' );
    $c->set( 'CONFIG_HAVE_ARCH_KGDB',                  'y' );
    $c->set( 'CONFIG_ARM_UNWIND',                      'y' );
    $c->set( 'CONFIG_DEBUG_USER',                      'y' );
    $c->set( 'CONFIG_DEBUG_LL',                        'y' );
    $c->set( 'CONFIG_CMDLINE_EXTEND',                  'y' );
    $c->set( 'CONFIG_DEBUG_LL_UART_NONE',              'y' );
    $c->set( 'CONFIG_EARLY_PRINTK',                    'y' );
    $c->set( 'CONFIG_SERIAL_CORE',                     'y' );
    $c->set( 'CONFIG_SERIAL_CORE_CONSOLE',             'y' );
    $c->set( 'CONFIG_SQUASHFS_XZ',                     'y' );
    $c->set( 'CONFIG_SQUASHFS_ZLIB',                   'y' );
    $c->set( 'CONFIG_FUTEX',                           'y' );
    $c->set( 'CONFIG_RCU_CPU_STALL_TIMEOUT',           '60' );
    $c->set( 'CONFIG_FRAME_WARN',                      '2048' );
    $c->set( 'CONFIG_ARCH_SUSPEND_POSSIBLE',           'y' );
    $c->set( 'CONFIG_ARCH_BINFMT_ELF_RAMDOMIZE_PIE',   'y' );
    $c->set( 'CONFIG_HAVE_AOUT',                       'y' );
    $c->set( 'CONFIG_USE_GENERIC_SMP_HELPERS',         'y' );
    $c->set( 'CONFIG_HAVE_REGS_AND_STACK_ACCESS_API',  'y' );
    $c->set( 'CONFIG_HAVE_CLK',                        'y' );
    $c->set( 'CONFIG_RT_MUTEXES',                      'y' );
    $c->set( 'CONFIG_SWAP',                            'y' );
    $c->set( 'CONFIG_HAVE_MEMBLOCK',                   'y' );
    $c->set( 'CONFIG_PAGEFLAGS_EXTENDED',              'y' );
    $c->set( 'CONFIG_VIRT_TO_BUS',                     'y' );
    $c->set( 'CONFIG_NEED_DMA_MAP_STATE',              'y' );
    $c->set( 'CONFIG_RCU_FANOUT',                      '32' );
#    $c->set( 'CONFIG_SERIAL_AMBA_PL011',               'y' );
#    $c->set( 'CONFIG_SERIAL_AMBA_PL011_CONSOLE',       'y' );
    if ( $chip =~ /^(63138)$/ ) {
        $c->set( 'CONFIG_BCM_CPU_ARCH_NAME',               '"arma9"' );
        $c->set( 'CONFIG_BCM963138',                       'y' );
        $c->set( 'CONFIG_MACH_BCM963138',                  'y' );
        $c->set( 'CONFIG_PLAT_CA9_MPCORE',                 'y' );
        $c->set( 'CONFIG_PLAT_BCM63138',                   'y' );
        $c->set( 'CONFIG_NR_CPUS',                         '2' );
        if ( $p->get('BRCM_BOARD_ID') eq "\"ikos\"") {
            $c->set( 'CONFIG_BCM63138_SIM',                    'y' );
        }
        $c->set( 'CONFIG_ARM_BCM63XX_CPUFREQ',             'y' );
        $c->set( 'CONFIG_CPU_FREQ_DEFAULT_GOV_USERSPACE',  'y' );
        $c->set( 'CONFIG_CPU_FREQ_GOV_ONDEMAND',           'y' );
    }
    if ( $chip =~ /^(63148)$/ ) {
        $c->set( 'CONFIG_BCM_CPU_ARCH_NAME',               '"armb15"' );
        $c->set( 'CONFIG_BCM963148',                       'y' );
        $c->set( 'CONFIG_MACH_BCM963148',                  'y' );
        $c->set( 'CONFIG_PLAT_B15_CORE',                   'y' );
        $c->set( 'CONFIG_PLAT_BCM63148',                   'y' );
        $c->set( 'CONFIG_NR_CPUS',                         '2' );
        $c->set( 'CONFIG_HIGHMEM',                         'y' );
        if ( $p->get('BRCM_BOARD_ID') eq "\"ikos\"") {
            $c->set( 'CONFIG_BCM63148_SIM',                    'y' );
        }
        $c->set( 'CONFIG_ARM_BCM63XX_CPUFREQ',             'y' );
        $c->set( 'CONFIG_CPU_FREQ_DEFAULT_GOV_USERSPACE',  'y' );
        $c->set( 'CONFIG_CPU_FREQ_GOV_ONDEMAND',           'y' );
    }
    if ( $p->get('BRCM_BOARD_ID') eq "\"ikos\"") {
        $c->set( 'CONFIG_CMDLINE_FORCE',                   'y' );
        $c->set( 'CONFIG_EXT2_FS',                         'y' );
        $c->set( 'CONFIG_KALLSYMS',                        'y' );
        $c->set( 'CONFIG_DEBUG_INFO',                      'y' );
        $c->unset( 'CONFIG_ARM_BCM63XX_CPUFREQ' );
    }
    $c->set( 'CONFIG_CPU_LITTLE_ENDIAN',               'y' );
    $c->set( 'CONFIG_CPU_BIG_ENDIAN',                undef );
    $c->set( 'CONFIG_LBDAF',                           'y' );
}
else {
    $c->set( 'CONFIG_BCM_CPU_ARCH_NAME',    '"mips32"' );
    $c->set( 'CONFIG_RCU_CPU_STALL_TIMEOUT',                 '60' );
    $c->set( 'CONFIG_CRYPTO_ECB',                            'm' );
    $c->set( 'CONFIG_BCM_PKTDMA_RX_SPLITTING',               'y' );
    $c->set( 'CONFIG_USE_GENERIC_SMP_HELPERS',               'y' );
    $c->set( 'CONFIG_NET_ETHERNET',                          'y' );
    $c->set( 'CONFIG_NR_CPUS',                               '2' );
    $c->set( 'CONFIG_INET_TCP_DIAG',                         'y' );
    $c->set( 'CONFIG_BCM_KERNEL_CUSTOM',                     'y' );
    $c->set( 'CONFIG_LOG_BUF_SHIFT',                         '14' );
    $c->set( 'CONFIG_MTD_ROM',                               'y' );
    $c->set( 'CONFIG_DMA_NEED_PCI_MAP_STATE',                'y' );
    $c->set( 'CONFIG_BRCM_MEMORY_RESTRICTION_OFF',           'y' );
    $c->set( 'CONFIG_MIPS32',                                'y' );
    $c->set( 'CONFIG_MIPS_BRCM',                             'y' );
    $c->set( 'CONFIG_MISC_DEVICES',                          'y' );
    $c->set( 'CONFIG_NETDEV_1000',                           'y' );
    $c->set( 'CONFIG_CRYPTO_AES',                            'y' );
    $c->set( 'CONFIG_MODULE_FORCE_UNLOAD',                   'y' );
    $c->set( 'CONFIG_USB_PRINTER',                           'y' );
    $c->set( 'CONFIG_BCM_BPM_BUF_MEM_PRCNT',                 '15' );
    $c->set( 'CONFIG_GENERIC_FIND_NEXT_BIT',                 'y' );
    $c->set( 'CONFIG_BRCMNAND_MINOR_VERS',                   '1' );
    $c->set( 'CONFIG_NETDEV_10000',                          'y' );
    $c->set( 'CONFIG_KMOD',                                  'y' );
    $c->set( 'CONFIG_MTD_BRCMNAND_CORRECTABLE_ERR_HANDLING', 'y' );
    $c->set( 'CONFIG_NF_CONNTRACK_ENABLED',                  'm' );
    $c->set( 'CONFIG_MIPS_L1_CACHE_SHIFT',                   '4' );
    $c->set( 'CONFIG_SYS_SUPPORTS_ARBIT_HZ',                 'y' );
    $c->set( 'CONFIG_BRCMNAND_MAJOR_VERS',                   '2' );
    $c->set( 'CONFIG_ATM_DRIVERS',                           'y' );
    $c->set( 'CONFIG_BCM_PKTDMA_TX_SPLITTING',               'y' );
    $c->set( 'CONFIG_NF_CONNTRACK_SUPPORT',                  'y' );
    $c->set( 'CONFIG_RCU_CPU_STALL_VERBOSE',                 'y' );
    $c->set( 'CONFIG_GENERIC_TIME',                          'y' );
    $c->set( 'CONFIG_IP_FIB_HASH',                           'y' );
    $c->set( 'CONFIG_BRANCH_PROFILE_NONE',                   'y' );
    $c->set( 'CONFIG_BOOTPARAM_HUNG_TASK_PANIC_VALUE',       '0' );
    $c->set( 'CONFIG_PREEMPT_VOLUNTARY',                     'y' );
    $c->set( 'CONFIG_TMPFS',                                 'y' );
    $c->set( 'CONFIG_IP_MROUTE',                             'y' );
    $c->set( 'CONFIG_COMPAT_NET_DEV_OPS',                    'y' );
    $c->set( 'CONFIG_XZ_DEC_X86',                            'y' );
    $c->set( 'CONFIG_CLEAN_COMPILE',                         'y' );
    $c->set( 'CONFIG_SCHED_NO_NO_OMIT_FRAME_POINTER',        'y' );
    $c->set( 'CONFIG_XZ_DEC',                                'y' );
    $c->set( 'CONFIG_TINY_SHMEM',                            'y' );
    $c->set( 'CONFIG_I2C_HELPER_AUTO',                       'y' );
    $c->set( 'CONFIG_HZ_1000',                               'y' );
    $c->set( 'CONFIG_CROSSCOMPILE',                          'y' );
    $c->set( 'CONFIG_INET_DIAG',                             'y' );
    $c->set( 'CONFIG_OBSOLETE_MODPARM',                      'y' );
    $c->set( 'CONFIG_SYSCTL_SYSCALL_CHECK',                  'y' );
    $c->set( 'CONFIG_RAMFS',                                 'y' );
    $c->set( 'CONFIG_LBDAF',                                 'y' );
    $c->set( 'CONFIG_SQUASHFS_XZ',                           'y' );
    $c->set( 'CONFIG_KLOB',                                  'y' );
    $c->set( 'CONFIG_ENABLE_MUST_CHECK',                     'y' );
    $c->set( 'CONFIG_CRYPTO_PCBC',                           'm' );
    $c->set( 'CONFIG_FRAME_WARN',                            '1024' );
    $c->set( 'CONFIG_I2C_COMPAT',                            'y' );
    $c->set( 'CONFIG_NETFILTER_XT_MARK',                     'm' );
    $c->set( 'CONFIG_DEVKMEM',                               'y' );
    $c->set( 'CONFIG_MTD_BCM963XX',                          'y' );
    $c->set( 'CONFIG_MIPS_BCM963XX',                         'y' );
    $c->set( 'CONFIG_CLASSIC_RCU',                           'y' );
    $c->set( 'CONFIG_VM_EVENT_COUNTERS',                     'y' );
    $c->set( 'CONFIG_BCM_WLAN_IMPL_SELECT',                  '""' );
    $c->set( 'CONFIG_FTRACE',                                'y' );
    $c->set( 'CONFIG_PREEMPT_SOFTIRQS',                      'y' );
    $c->set( 'CONFIG_DEVPTS_MULTIPLE_INSTANCES',             'y' );
    $c->set( 'CONFIG_BOOTPARAM_SOFTLOCKUP_PANIC_VALUE',      '0' );
    $c->set( 'CONFIG_RCU_FANOUT',                            '32' );
    $c->set( 'CONFIG_BCM_DCACHE_SHARED',                     'y' );
}
if ( $chip eq '60333' ) {
    $c->set( 'CONFIG_BCM_CPU_ARCH_NAME',                     '"mips32el"' );
    $c->set( 'CONFIG_CPU_LITTLE_ENDIAN',                     'y' );
    $c->set( 'CONFIG_CPU_BIG_ENDIAN',                        undef );
}

if ( $chip eq '6838' ) {       
    $c->set( 'CONFIG_BCM_BRIDGE_MAC_FDB_LIMIT',              'y' );
}
$c->write();

